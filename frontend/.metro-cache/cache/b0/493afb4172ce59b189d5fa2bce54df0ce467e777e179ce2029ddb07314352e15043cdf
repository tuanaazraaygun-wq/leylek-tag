{"dependencies":[{"name":"ts-interface-checker","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":54,"index":54}}],"key":"HfhaKjnice1fCpg0Sn7EyYWsNYo=","exportNames":["*"],"imports":1}},{"name":"../AgoraBase","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":55},"end":{"line":2,"column":45,"index":100}}],"key":"DlZ3bIZKenMx+ASVBy9vnXRtwdo=","exportNames":["*"],"imports":1}},{"name":"../impl/IAgoraMediaRecorderImpl","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":101},"end":{"line":3,"column":69,"index":170}}],"key":"E08aYQSotczmkUUZQgZFmbabu8U=","exportNames":["*"],"imports":1}},{"name":"../ti/AgoraMediaBase-ti","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":171},"end":{"line":4,"column":55,"index":226}}],"key":"QZ6mImaAognVYZX7es9N8fUStRE=","exportNames":["*"],"imports":1}},{"name":"./IrisApiEngine","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":6,"column":0,"index":278},"end":{"line":6,"column":65,"index":343}}],"key":"0UpvluOwke2G7Jk/PkNw9qFcW40=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"MediaRecorderInternal\", {\n    enumerable: true,\n    get: function () {\n      return MediaRecorderInternal;\n    }\n  });\n  var _tsInterfaceChecker = require(_dependencyMap[0], \"ts-interface-checker\");\n  var _AgoraBase = require(_dependencyMap[1], \"../AgoraBase\");\n  var _implIAgoraMediaRecorderImpl = require(_dependencyMap[2], \"../impl/IAgoraMediaRecorderImpl\");\n  var _tiAgoraMediaBaseTi = require(_dependencyMap[3], \"../ti/AgoraMediaBase-ti\");\n  var AgoraMediaBaseTI = _interopDefault(_tiAgoraMediaBaseTi);\n  var _IrisApiEngine = require(_dependencyMap[4], \"./IrisApiEngine\");\n  const checkers = (0, _tsInterfaceChecker.createCheckers)(AgoraMediaBaseTI.default);\n  class MediaRecorderInternal extends _implIAgoraMediaRecorderImpl.IMediaRecorderImpl {\n    static _observers = new Map();\n    constructor(nativeHandle) {\n      super();\n      this._nativeHandle = nativeHandle;\n    }\n    release() {\n      MediaRecorderInternal._observers.delete(this._nativeHandle);\n      this.removeAllListeners();\n    }\n    get nativeHandle() {\n      return this._nativeHandle;\n    }\n    setMediaRecorderObserver(callback) {\n      const key = this._nativeHandle;\n      if (MediaRecorderInternal._observers.has(key)) {\n        return _AgoraBase.ErrorCodeType.ErrOk;\n      }\n      MediaRecorderInternal._observers.set(key, callback);\n      return super.setMediaRecorderObserver(callback);\n    }\n    _addListenerPreCheck(eventType) {\n      var _checkers$IMediaRecor;\n      if ((_checkers$IMediaRecor = checkers.IMediaRecorderObserver) !== null && _checkers$IMediaRecor !== void 0 && _checkers$IMediaRecor.strictTest({\n        [eventType]: undefined\n      })) {\n        if (MediaRecorderInternal._observers.get(this._nativeHandle) === undefined) {\n          this.setMediaRecorderObserver({});\n        }\n      }\n      return true;\n    }\n    addListener(eventType, listener) {\n      this._addListenerPreCheck(eventType);\n      const callback = (eventProcessor, data) => {\n        if (eventProcessor.type(data) !== _IrisApiEngine.EVENT_TYPE.IMediaRecorder) {\n          return;\n        }\n        if (data.nativeHandle !== this._nativeHandle) {\n          return;\n        }\n        eventProcessor.func.map(it => {\n          it({\n            [eventType]: listener\n          }, eventType, data);\n        });\n      };\n      // @ts-ignore\n      listener.agoraCallback = callback;\n      _IrisApiEngine.DeviceEventEmitter.addListener(eventType, callback);\n    }\n    removeListener(eventType, listener) {\n      _IrisApiEngine.DeviceEventEmitter.removeListener(eventType,\n      // @ts-ignore\n      (listener === null || listener === void 0 ? void 0 : listener.agoraCallback) ?? listener);\n    }\n    removeAllListeners(eventType) {\n      _IrisApiEngine.DeviceEventEmitter.removeAllListeners(eventType);\n    }\n  }\n});","lineCount":85,"map":[[12,2,7,0,"Object"],[12,8,7,0],[12,9,7,0,"defineProperty"],[12,23,7,0],[12,24,7,0,"exports"],[12,31,7,0],[13,4,7,0,"enumerable"],[13,14,7,0],[14,4,7,0,"get"],[14,7,7,0],[14,18,7,0,"get"],[14,19,7,0],[15,6,7,0],[15,13,7,0,"MediaRecorderInternal"],[15,34,7,0],[16,4,7,0],[17,2,7,0],[18,2,1,0],[18,6,1,0,"_tsInterfaceChecker"],[18,25,1,0],[18,28,1,0,"require"],[18,35,1,0],[18,36,1,0,"_dependencyMap"],[18,50,1,0],[19,2,2,0],[19,6,2,0,"_AgoraBase"],[19,16,2,0],[19,19,2,0,"require"],[19,26,2,0],[19,27,2,0,"_dependencyMap"],[19,41,2,0],[20,2,3,0],[20,6,3,0,"_implIAgoraMediaRecorderImpl"],[20,34,3,0],[20,37,3,0,"require"],[20,44,3,0],[20,45,3,0,"_dependencyMap"],[20,59,3,0],[21,2,4,0],[21,6,4,0,"_tiAgoraMediaBaseTi"],[21,25,4,0],[21,28,4,0,"require"],[21,35,4,0],[21,36,4,0,"_dependencyMap"],[21,50,4,0],[22,2,4,0],[22,6,4,0,"AgoraMediaBaseTI"],[22,22,4,0],[22,25,4,0,"_interopDefault"],[22,40,4,0],[22,41,4,0,"_tiAgoraMediaBaseTi"],[22,60,4,0],[23,2,6,0],[23,6,6,0,"_IrisApiEngine"],[23,20,6,0],[23,23,6,0,"require"],[23,30,6,0],[23,31,6,0,"_dependencyMap"],[23,45,6,0],[24,2,5,0],[24,8,5,6,"checkers"],[24,16,5,14],[24,19,5,17],[24,23,5,17,"createCheckers"],[24,42,5,31],[24,43,5,31,"createCheckers"],[24,57,5,31],[24,59,5,32,"AgoraMediaBaseTI"],[24,75,5,48],[24,76,5,48,"default"],[24,83,5,48],[24,84,5,49],[25,2,7,7],[25,8,7,13,"MediaRecorderInternal"],[25,29,7,34],[25,38,7,43,"IMediaRecorderImpl"],[25,66,7,61],[25,67,7,61,"IMediaRecorderImpl"],[25,85,7,61],[25,86,7,62],[26,4,8,2],[26,11,8,9,"_observers"],[26,21,8,19],[26,24,8,22],[26,28,8,26,"Map"],[26,31,8,29],[26,32,8,30],[26,33,8,31],[27,4,9,2,"constructor"],[27,15,9,13,"constructor"],[27,16,9,14,"nativeHandle"],[27,28,9,26],[27,30,9,28],[28,6,10,4],[28,11,10,9],[28,12,10,10],[28,13,10,11],[29,6,11,4],[29,10,11,8],[29,11,11,9,"_nativeHandle"],[29,24,11,22],[29,27,11,25,"nativeHandle"],[29,39,11,37],[30,4,12,2],[31,4,13,2,"release"],[31,11,13,9,"release"],[31,12,13,9],[31,14,13,12],[32,6,14,4,"MediaRecorderInternal"],[32,27,14,25],[32,28,14,26,"_observers"],[32,38,14,36],[32,39,14,37,"delete"],[32,45,14,43],[32,46,14,44],[32,50,14,48],[32,51,14,49,"_nativeHandle"],[32,64,14,62],[32,65,14,63],[33,6,15,4],[33,10,15,8],[33,11,15,9,"removeAllListeners"],[33,29,15,27],[33,30,15,28],[33,31,15,29],[34,4,16,2],[35,4,17,2],[35,8,17,6,"nativeHandle"],[35,20,17,18,"nativeHandle"],[35,21,17,18],[35,23,17,21],[36,6,18,4],[36,13,18,11],[36,17,18,15],[36,18,18,16,"_nativeHandle"],[36,31,18,29],[37,4,19,2],[38,4,20,2,"setMediaRecorderObserver"],[38,28,20,26,"setMediaRecorderObserver"],[38,29,20,27,"callback"],[38,37,20,35],[38,39,20,37],[39,6,21,4],[39,12,21,10,"key"],[39,15,21,13],[39,18,21,16],[39,22,21,20],[39,23,21,21,"_nativeHandle"],[39,36,21,34],[40,6,22,4],[40,10,22,8,"MediaRecorderInternal"],[40,31,22,29],[40,32,22,30,"_observers"],[40,42,22,40],[40,43,22,41,"has"],[40,46,22,44],[40,47,22,45,"key"],[40,50,22,48],[40,51,22,49],[40,53,22,51],[41,8,23,6],[41,15,23,13,"ErrorCodeType"],[41,25,23,26],[41,26,23,26,"ErrorCodeType"],[41,39,23,26],[41,40,23,27,"ErrOk"],[41,45,23,32],[42,6,24,4],[43,6,25,4,"MediaRecorderInternal"],[43,27,25,25],[43,28,25,26,"_observers"],[43,38,25,36],[43,39,25,37,"set"],[43,42,25,40],[43,43,25,41,"key"],[43,46,25,44],[43,48,25,46,"callback"],[43,56,25,54],[43,57,25,55],[44,6,26,4],[44,13,26,11],[44,18,26,16],[44,19,26,17,"setMediaRecorderObserver"],[44,43,26,41],[44,44,26,42,"callback"],[44,52,26,50],[44,53,26,51],[45,4,27,2],[46,4,28,2,"_addListenerPreCheck"],[46,24,28,22,"_addListenerPreCheck"],[46,25,28,23,"eventType"],[46,34,28,32],[46,36,28,34],[47,6,29,4],[47,10,29,8,"_checkers$IMediaRecor"],[47,31,29,29],[48,6,30,4],[48,10,30,8],[48,11,30,9,"_checkers$IMediaRecor"],[48,32,30,30],[48,35,30,33,"checkers"],[48,43,30,41],[48,44,30,42,"IMediaRecorderObserver"],[48,66,30,64],[48,72,30,70],[48,76,30,74],[48,80,30,78,"_checkers$IMediaRecor"],[48,101,30,99],[48,106,30,104],[48,111,30,109],[48,112,30,110],[48,116,30,114,"_checkers$IMediaRecor"],[48,137,30,135],[48,138,30,136,"strictTest"],[48,148,30,146],[48,149,30,147],[49,8,31,6],[49,9,31,7,"eventType"],[49,18,31,16],[49,21,31,19,"undefined"],[50,6,32,4],[50,7,32,5],[50,8,32,6],[50,10,32,8],[51,8,33,6],[51,12,33,10,"MediaRecorderInternal"],[51,33,33,31],[51,34,33,32,"_observers"],[51,44,33,42],[51,45,33,43,"get"],[51,48,33,46],[51,49,33,47],[51,53,33,51],[51,54,33,52,"_nativeHandle"],[51,67,33,65],[51,68,33,66],[51,73,33,71,"undefined"],[51,82,33,80],[51,84,33,82],[52,10,34,8],[52,14,34,12],[52,15,34,13,"setMediaRecorderObserver"],[52,39,34,37],[52,40,34,38],[52,41,34,39],[52,42,34,40],[52,43,34,41],[53,8,35,6],[54,6,36,4],[55,6,37,4],[55,13,37,11],[55,17,37,15],[56,4,38,2],[57,4,39,2,"addListener"],[57,15,39,13,"addListener"],[57,16,39,14,"eventType"],[57,25,39,23],[57,27,39,25,"listener"],[57,35,39,33],[57,37,39,35],[58,6,40,4],[58,10,40,8],[58,11,40,9,"_addListenerPreCheck"],[58,31,40,29],[58,32,40,30,"eventType"],[58,41,40,39],[58,42,40,40],[59,6,41,4],[59,12,41,10,"callback"],[59,20,41,18],[59,23,41,21,"callback"],[59,24,41,22,"eventProcessor"],[59,38,41,36],[59,40,41,38,"data"],[59,44,41,42],[59,49,41,47],[60,8,42,6],[60,12,42,10,"eventProcessor"],[60,26,42,24],[60,27,42,25,"type"],[60,31,42,29],[60,32,42,30,"data"],[60,36,42,34],[60,37,42,35],[60,42,42,40,"EVENT_TYPE"],[60,56,42,50],[60,57,42,50,"EVENT_TYPE"],[60,67,42,50],[60,68,42,51,"IMediaRecorder"],[60,82,42,65],[60,84,42,67],[61,10,43,8],[62,8,44,6],[63,8,45,6],[63,12,45,10,"data"],[63,16,45,14],[63,17,45,15,"nativeHandle"],[63,29,45,27],[63,34,45,32],[63,38,45,36],[63,39,45,37,"_nativeHandle"],[63,52,45,50],[63,54,45,52],[64,10,46,8],[65,8,47,6],[66,8,48,6,"eventProcessor"],[66,22,48,20],[66,23,48,21,"func"],[66,27,48,25],[66,28,48,26,"map"],[66,31,48,29],[66,32,48,30,"it"],[66,34,48,32],[66,38,48,36],[67,10,49,8,"it"],[67,12,49,10],[67,13,49,11],[68,12,50,10],[68,13,50,11,"eventType"],[68,22,50,20],[68,25,50,23,"listener"],[69,10,51,8],[69,11,51,9],[69,13,51,11,"eventType"],[69,22,51,20],[69,24,51,22,"data"],[69,28,51,26],[69,29,51,27],[70,8,52,6],[70,9,52,7],[70,10,52,8],[71,6,53,4],[71,7,53,5],[72,6,54,4],[73,6,55,4,"listener"],[73,14,55,12],[73,15,55,13,"agoraCallback"],[73,28,55,26],[73,31,55,29,"callback"],[73,39,55,37],[74,6,56,4,"DeviceEventEmitter"],[74,20,56,22],[74,21,56,22,"DeviceEventEmitter"],[74,39,56,22],[74,40,56,23,"addListener"],[74,51,56,34],[74,52,56,35,"eventType"],[74,61,56,44],[74,63,56,46,"callback"],[74,71,56,54],[74,72,56,55],[75,4,57,2],[76,4,58,2,"removeListener"],[76,18,58,16,"removeListener"],[76,19,58,17,"eventType"],[76,28,58,26],[76,30,58,28,"listener"],[76,38,58,36],[76,40,58,38],[77,6,59,4,"DeviceEventEmitter"],[77,20,59,22],[77,21,59,22,"DeviceEventEmitter"],[77,39,59,22],[77,40,59,23,"removeListener"],[77,54,59,37],[77,55,59,38,"eventType"],[77,64,59,47],[78,6,60,4],[79,6,61,4],[79,7,61,5,"listener"],[79,15,61,13],[79,20,61,18],[79,24,61,22],[79,28,61,26,"listener"],[79,36,61,34],[79,41,61,39],[79,46,61,44],[79,47,61,45],[79,50,61,48],[79,55,61,53],[79,56,61,54],[79,59,61,57,"listener"],[79,67,61,65],[79,68,61,66,"agoraCallback"],[79,81,61,79],[79,86,61,84,"listener"],[79,94,61,92],[79,95,61,93],[80,4,62,2],[81,4,63,2,"removeAllListeners"],[81,22,63,20,"removeAllListeners"],[81,23,63,21,"eventType"],[81,32,63,30],[81,34,63,32],[82,6,64,4,"DeviceEventEmitter"],[82,20,64,22],[82,21,64,22,"DeviceEventEmitter"],[82,39,64,22],[82,40,64,23,"removeAllListeners"],[82,58,64,41],[82,59,64,42,"eventType"],[82,68,64,51],[82,69,64,52],[83,4,65,2],[84,2,66,0],[85,0,66,1],[85,3]],"functionMap":{"names":["<global>","MediaRecorderInternal","constructor","release","get__nativeHandle","setMediaRecorderObserver","_addListenerPreCheck","addListener","callback","eventProcessor.func.map$argument_0","removeListener","removeAllListeners"],"mappings":"AAA;OCM;ECE;GDG;EEC;GFG;EGC;GHE;EIC;GJO;EKC;GLU;EMC;qBCE;8BCO;ODI;KDC;GNI;ESC;GTI;EUC;GVE;CDC"},"hasCjsExports":false},"type":"js/module"}]}
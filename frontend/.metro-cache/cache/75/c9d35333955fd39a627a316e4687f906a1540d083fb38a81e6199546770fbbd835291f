{"dependencies":[{"name":"react-native-web/dist/exports/NativeModules","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"MRft9soElPgDBIQyAww27iefYeU=","exportNames":["*"],"imports":1}},{"name":"./MediaStream","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":61},"end":{"line":4,"column":40,"index":101}}],"key":"3Kf/979wvknqzqe4InQeiqZ8m2s=","exportNames":["*"],"imports":1}},{"name":"./MediaStreamError","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":5,"column":0,"index":102},"end":{"line":5,"column":50,"index":152}}],"key":"5hhVF4xhNA5cg/hI7Pd+vQPtSQY=","exportNames":["*"],"imports":1}},{"name":"./Permissions","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":6,"column":0,"index":153},"end":{"line":6,"column":40,"index":193}}],"key":"VwP+mbjkHwVEbn+H2lb3+ywyBqM=","exportNames":["*"],"imports":1}},{"name":"./RTCUtil","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":7,"column":0,"index":194},"end":{"line":7,"column":37,"index":231}}],"key":"CN8UyESr1mxcK8UZcasAG4s3jsI=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  function _interopNamespace(e) {\n    if (e && e.__esModule) return e;\n    var n = {};\n    if (e) Object.keys(e).forEach(function (k) {\n      var d = Object.getOwnPropertyDescriptor(e, k);\n      Object.defineProperty(n, k, d.get ? d : {\n        enumerable: true,\n        get: function () {\n          return e[k];\n        }\n      });\n    });\n    n.default = e;\n    return n;\n  }\n  Object.defineProperty(exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return getUserMedia;\n    }\n  });\n  var _reactNativeWebDistExportsNativeModules = require(_dependencyMap[0], \"react-native-web/dist/exports/NativeModules\");\n  var NativeModules = _interopDefault(_reactNativeWebDistExportsNativeModules);\n  var _MediaStream = require(_dependencyMap[1], \"./MediaStream\");\n  var MediaStream = _interopDefault(_MediaStream);\n  var _MediaStreamError = require(_dependencyMap[2], \"./MediaStreamError\");\n  var MediaStreamError = _interopDefault(_MediaStreamError);\n  var _Permissions = require(_dependencyMap[3], \"./Permissions\");\n  var permissions = _interopDefault(_Permissions);\n  var _RTCUtil = require(_dependencyMap[4], \"./RTCUtil\");\n  var RTCUtil = _interopNamespace(_RTCUtil);\n  const {\n    WebRTCModule\n  } = NativeModules.default;\n  function getUserMedia(constraints = {}) {\n    // According to\n    // https://www.w3.org/TR/mediacapture-streams/#dom-mediadevices-getusermedia,\n    // the constraints argument is a dictionary of type MediaStreamConstraints.\n    if (typeof constraints !== 'object') {\n      return Promise.reject(new TypeError('constraints is not a dictionary'));\n    }\n    if ((typeof constraints.audio === 'undefined' || !constraints.audio) && (typeof constraints.video === 'undefined' || !constraints.video)) {\n      return Promise.reject(new TypeError('audio and/or video is required'));\n    }\n\n    // Normalize constraints.\n    constraints = RTCUtil.normalizeConstraints(constraints);\n\n    // Request required permissions\n    const reqPermissions = [];\n    if (constraints.audio) {\n      reqPermissions.push(permissions.default.request({\n        name: 'microphone'\n      }));\n    } else {\n      reqPermissions.push(Promise.resolve(false));\n    }\n    if (constraints.video) {\n      reqPermissions.push(permissions.default.request({\n        name: 'camera'\n      }));\n    } else {\n      reqPermissions.push(Promise.resolve(false));\n    }\n    return new Promise((resolve, reject) => {\n      Promise.all(reqPermissions).then(results => {\n        const [audioPerm, videoPerm] = results;\n\n        // Check permission results and remove unneeded permissions.\n\n        if (!audioPerm && !videoPerm) {\n          // https://www.w3.org/TR/mediacapture-streams/#dom-mediadevices-getusermedia\n          // step 4\n          const error = {\n            message: 'Permission denied.',\n            name: 'SecurityError'\n          };\n          reject(new MediaStreamError.default(error));\n          return;\n        }\n        audioPerm || delete constraints.audio;\n        videoPerm || delete constraints.video;\n        const success = (id, tracks) => {\n          // Store initial constraints.\n          for (const trackInfo of tracks) {\n            const c = constraints[trackInfo.kind];\n            if (typeof c === 'object') {\n              trackInfo.constraints = RTCUtil.deepClone(c);\n            }\n          }\n          const info = {\n            streamId: id,\n            streamReactTag: id,\n            tracks\n          };\n          resolve(new MediaStream.default(info));\n        };\n        const failure = (type, message) => {\n          let error;\n          switch (type) {\n            case 'TypeError':\n              error = new TypeError(message);\n              break;\n          }\n          if (!error) {\n            error = new MediaStreamError.default({\n              message,\n              name: type\n            });\n          }\n          reject(error);\n        };\n        WebRTCModule.getUserMedia(constraints, success, failure);\n      });\n    });\n  }\n});","lineCount":128,"map":[[2,2,1,0],[2,14,1,12],[4,2,1,13,"Object"],[4,8,1,13],[4,9,1,13,"defineProperty"],[4,23,1,13],[4,24,1,13,"exports"],[4,31,1,13],[5,4,1,13,"value"],[5,9,1,13],[6,2,1,13],[7,2,1,13],[7,11,1,13,"_interopDefault"],[7,27,1,13,"e"],[7,28,1,13],[8,4,1,13],[8,11,1,13,"e"],[8,12,1,13],[8,16,1,13,"e"],[8,17,1,13],[8,18,1,13,"__esModule"],[8,28,1,13],[8,31,1,13,"e"],[8,32,1,13],[9,6,1,13,"default"],[9,13,1,13],[9,15,1,13,"e"],[10,4,1,13],[11,2,1,13],[12,2,1,13],[12,11,1,13,"_interopNamespace"],[12,29,1,13,"e"],[12,30,1,13],[13,4,1,13],[13,8,1,13,"e"],[13,9,1,13],[13,13,1,13,"e"],[13,14,1,13],[13,15,1,13,"__esModule"],[13,25,1,13],[13,34,1,13,"e"],[13,35,1,13],[14,4,1,13],[14,8,1,13,"n"],[14,9,1,13],[15,4,1,13],[15,8,1,13,"e"],[15,9,1,13],[15,11,1,13,"Object"],[15,17,1,13],[15,18,1,13,"keys"],[15,22,1,13],[15,23,1,13,"e"],[15,24,1,13],[15,26,1,13,"forEach"],[15,33,1,13],[15,44,1,13,"k"],[15,45,1,13],[16,6,1,13],[16,10,1,13,"d"],[16,11,1,13],[16,14,1,13,"Object"],[16,20,1,13],[16,21,1,13,"getOwnPropertyDescriptor"],[16,45,1,13],[16,46,1,13,"e"],[16,47,1,13],[16,49,1,13,"k"],[16,50,1,13],[17,6,1,13,"Object"],[17,12,1,13],[17,13,1,13,"defineProperty"],[17,27,1,13],[17,28,1,13,"n"],[17,29,1,13],[17,31,1,13,"k"],[17,32,1,13],[17,34,1,13,"d"],[17,35,1,13],[17,36,1,13,"get"],[17,39,1,13],[17,42,1,13,"d"],[17,43,1,13],[18,8,1,13,"enumerable"],[18,18,1,13],[19,8,1,13,"get"],[19,11,1,13],[19,22,1,13,"get"],[19,23,1,13],[20,10,1,13],[20,17,1,13,"e"],[20,18,1,13],[20,19,1,13,"k"],[20,20,1,13],[21,8,1,13],[22,6,1,13],[23,4,1,13],[24,4,1,13,"n"],[24,5,1,13],[24,6,1,13,"default"],[24,13,1,13],[24,16,1,13,"e"],[24,17,1,13],[25,4,1,13],[25,11,1,13,"n"],[25,12,1,13],[26,2,1,13],[27,2,11,15,"Object"],[27,8,11,15],[27,9,11,15,"defineProperty"],[27,23,11,15],[27,24,11,15,"exports"],[27,31,11,15],[28,4,11,15,"enumerable"],[28,14,11,15],[29,4,11,15,"get"],[29,7,11,15],[29,18,11,15,"get"],[29,19,11,15],[30,6,11,15],[30,13,11,15,"getUserMedia"],[30,25,11,15],[31,4,11,15],[32,2,11,15],[33,2,92,1],[33,6,92,1,"_reactNativeWebDistExportsNativeModules"],[33,45,92,1],[33,48,92,1,"require"],[33,55,92,1],[33,56,92,1,"_dependencyMap"],[33,70,92,1],[34,2,92,1],[34,6,92,1,"NativeModules"],[34,19,92,1],[34,22,92,1,"_interopDefault"],[34,37,92,1],[34,38,92,1,"_reactNativeWebDistExportsNativeModules"],[34,77,92,1],[35,2,4,0],[35,6,4,0,"_MediaStream"],[35,18,4,0],[35,21,4,0,"require"],[35,28,4,0],[35,29,4,0,"_dependencyMap"],[35,43,4,0],[36,2,4,0],[36,6,4,0,"MediaStream"],[36,17,4,0],[36,20,4,0,"_interopDefault"],[36,35,4,0],[36,36,4,0,"_MediaStream"],[36,48,4,0],[37,2,5,0],[37,6,5,0,"_MediaStreamError"],[37,23,5,0],[37,26,5,0,"require"],[37,33,5,0],[37,34,5,0,"_dependencyMap"],[37,48,5,0],[38,2,5,0],[38,6,5,0,"MediaStreamError"],[38,22,5,0],[38,25,5,0,"_interopDefault"],[38,40,5,0],[38,41,5,0,"_MediaStreamError"],[38,58,5,0],[39,2,6,0],[39,6,6,0,"_Permissions"],[39,18,6,0],[39,21,6,0,"require"],[39,28,6,0],[39,29,6,0,"_dependencyMap"],[39,43,6,0],[40,2,6,0],[40,6,6,0,"permissions"],[40,17,6,0],[40,20,6,0,"_interopDefault"],[40,35,6,0],[40,36,6,0,"_Permissions"],[40,48,6,0],[41,2,7,0],[41,6,7,0,"_RTCUtil"],[41,14,7,0],[41,17,7,0,"require"],[41,24,7,0],[41,25,7,0,"_dependencyMap"],[41,39,7,0],[42,2,7,0],[42,6,7,0,"RTCUtil"],[42,13,7,0],[42,16,7,0,"_interopNamespace"],[42,33,7,0],[42,34,7,0,"_RTCUtil"],[42,42,7,0],[43,2,8,0],[43,8,8,6],[44,4,9,2,"WebRTCModule"],[45,2,10,0],[45,3,10,1],[45,6,10,4,"NativeModules"],[45,19,10,17],[45,20,10,17,"default"],[45,27,10,17],[46,2,11,15],[46,11,11,24,"getUserMedia"],[46,23,11,36,"getUserMedia"],[46,24,11,37,"constraints"],[46,35,11,48],[46,38,11,51],[46,39,11,52],[46,40,11,53],[46,42,11,55],[47,4,12,2],[48,4,13,2],[49,4,14,2],[50,4,15,2],[50,8,15,6],[50,15,15,13,"constraints"],[50,26,15,24],[50,31,15,29],[50,39,15,37],[50,41,15,39],[51,6,16,4],[51,13,16,11,"Promise"],[51,20,16,18],[51,21,16,19,"reject"],[51,27,16,25],[51,28,16,26],[51,32,16,30,"TypeError"],[51,41,16,39],[51,42,16,40],[51,75,16,73],[51,76,16,74],[51,77,16,75],[52,4,17,2],[53,4,18,2],[53,8,18,6],[53,9,18,7],[53,16,18,14,"constraints"],[53,27,18,25],[53,28,18,26,"audio"],[53,33,18,31],[53,38,18,36],[53,49,18,47],[53,53,18,51],[53,54,18,52,"constraints"],[53,65,18,63],[53,66,18,64,"audio"],[53,71,18,69],[53,77,18,75],[53,84,18,82,"constraints"],[53,95,18,93],[53,96,18,94,"video"],[53,101,18,99],[53,106,18,104],[53,117,18,115],[53,121,18,119],[53,122,18,120,"constraints"],[53,133,18,131],[53,134,18,132,"video"],[53,139,18,137],[53,140,18,138],[53,142,18,140],[54,6,19,4],[54,13,19,11,"Promise"],[54,20,19,18],[54,21,19,19,"reject"],[54,27,19,25],[54,28,19,26],[54,32,19,30,"TypeError"],[54,41,19,39],[54,42,19,40],[54,74,19,72],[54,75,19,73],[54,76,19,74],[55,4,20,2],[57,4,22,2],[58,4,23,2,"constraints"],[58,15,23,13],[58,18,23,16,"RTCUtil"],[58,25,23,23],[58,26,23,24,"normalizeConstraints"],[58,46,23,44],[58,47,23,45,"constraints"],[58,58,23,56],[58,59,23,57],[60,4,25,2],[61,4,26,2],[61,10,26,8,"reqPermissions"],[61,24,26,22],[61,27,26,25],[61,29,26,27],[62,4,27,2],[62,8,27,6,"constraints"],[62,19,27,17],[62,20,27,18,"audio"],[62,25,27,23],[62,27,27,25],[63,6,28,4,"reqPermissions"],[63,20,28,18],[63,21,28,19,"push"],[63,25,28,23],[63,26,28,24,"permissions"],[63,37,28,35],[63,38,28,35,"default"],[63,45,28,35],[63,46,28,36,"request"],[63,53,28,43],[63,54,28,44],[64,8,29,6,"name"],[64,12,29,10],[64,14,29,12],[65,6,30,4],[65,7,30,5],[65,8,30,6],[65,9,30,7],[66,4,31,2],[66,5,31,3],[66,11,31,9],[67,6,32,4,"reqPermissions"],[67,20,32,18],[67,21,32,19,"push"],[67,25,32,23],[67,26,32,24,"Promise"],[67,33,32,31],[67,34,32,32,"resolve"],[67,41,32,39],[67,42,32,40],[67,47,32,45],[67,48,32,46],[67,49,32,47],[68,4,33,2],[69,4,34,2],[69,8,34,6,"constraints"],[69,19,34,17],[69,20,34,18,"video"],[69,25,34,23],[69,27,34,25],[70,6,35,4,"reqPermissions"],[70,20,35,18],[70,21,35,19,"push"],[70,25,35,23],[70,26,35,24,"permissions"],[70,37,35,35],[70,38,35,35,"default"],[70,45,35,35],[70,46,35,36,"request"],[70,53,35,43],[70,54,35,44],[71,8,36,6,"name"],[71,12,36,10],[71,14,36,12],[72,6,37,4],[72,7,37,5],[72,8,37,6],[72,9,37,7],[73,4,38,2],[73,5,38,3],[73,11,38,9],[74,6,39,4,"reqPermissions"],[74,20,39,18],[74,21,39,19,"push"],[74,25,39,23],[74,26,39,24,"Promise"],[74,33,39,31],[74,34,39,32,"resolve"],[74,41,39,39],[74,42,39,40],[74,47,39,45],[74,48,39,46],[74,49,39,47],[75,4,40,2],[76,4,41,2],[76,11,41,9],[76,15,41,13,"Promise"],[76,22,41,20],[76,23,41,21],[76,24,41,22,"resolve"],[76,31,41,29],[76,33,41,31,"reject"],[76,39,41,37],[76,44,41,42],[77,6,42,4,"Promise"],[77,13,42,11],[77,14,42,12,"all"],[77,17,42,15],[77,18,42,16,"reqPermissions"],[77,32,42,30],[77,33,42,31],[77,34,42,32,"then"],[77,38,42,36],[77,39,42,37,"results"],[77,46,42,44],[77,50,42,48],[78,8,43,6],[78,14,43,12],[78,15,43,13,"audioPerm"],[78,24,43,22],[78,26,43,24,"videoPerm"],[78,35,43,33],[78,36,43,34],[78,39,43,37,"results"],[78,46,43,44],[80,8,45,6],[82,8,47,6],[82,12,47,10],[82,13,47,11,"audioPerm"],[82,22,47,20],[82,26,47,24],[82,27,47,25,"videoPerm"],[82,36,47,34],[82,38,47,36],[83,10,48,8],[84,10,49,8],[85,10,50,8],[85,16,50,14,"error"],[85,21,50,19],[85,24,50,22],[86,12,51,10,"message"],[86,19,51,17],[86,21,51,19],[86,41,51,39],[87,12,52,10,"name"],[87,16,52,14],[87,18,52,16],[88,10,53,8],[88,11,53,9],[89,10,54,8,"reject"],[89,16,54,14],[89,17,54,15],[89,21,54,19,"MediaStreamError"],[89,37,54,35],[89,38,54,35,"default"],[89,45,54,35],[89,46,54,36,"error"],[89,51,54,41],[89,52,54,42],[89,53,54,43],[90,10,55,8],[91,8,56,6],[92,8,57,6,"audioPerm"],[92,17,57,15],[92,21,57,19],[92,28,57,26,"constraints"],[92,39,57,37],[92,40,57,38,"audio"],[92,45,57,43],[93,8,58,6,"videoPerm"],[93,17,58,15],[93,21,58,19],[93,28,58,26,"constraints"],[93,39,58,37],[93,40,58,38,"video"],[93,45,58,43],[94,8,59,6],[94,14,59,12,"success"],[94,21,59,19],[94,24,59,22,"success"],[94,25,59,23,"id"],[94,27,59,25],[94,29,59,27,"tracks"],[94,35,59,33],[94,40,59,38],[95,10,60,8],[96,10,61,8],[96,15,61,13],[96,21,61,19,"trackInfo"],[96,30,61,28],[96,34,61,32,"tracks"],[96,40,61,38],[96,42,61,40],[97,12,62,10],[97,18,62,16,"c"],[97,19,62,17],[97,22,62,20,"constraints"],[97,33,62,31],[97,34,62,32,"trackInfo"],[97,43,62,41],[97,44,62,42,"kind"],[97,48,62,46],[97,49,62,47],[98,12,63,10],[98,16,63,14],[98,23,63,21,"c"],[98,24,63,22],[98,29,63,27],[98,37,63,35],[98,39,63,37],[99,14,64,12,"trackInfo"],[99,23,64,21],[99,24,64,22,"constraints"],[99,35,64,33],[99,38,64,36,"RTCUtil"],[99,45,64,43],[99,46,64,44,"deepClone"],[99,55,64,53],[99,56,64,54,"c"],[99,57,64,55],[99,58,64,56],[100,12,65,10],[101,10,66,8],[102,10,67,8],[102,16,67,14,"info"],[102,20,67,18],[102,23,67,21],[103,12,68,10,"streamId"],[103,20,68,18],[103,22,68,20,"id"],[103,24,68,22],[104,12,69,10,"streamReactTag"],[104,26,69,24],[104,28,69,26,"id"],[104,30,69,28],[105,12,70,10,"tracks"],[106,10,71,8],[106,11,71,9],[107,10,72,8,"resolve"],[107,17,72,15],[107,18,72,16],[107,22,72,20,"MediaStream"],[107,33,72,31],[107,34,72,31,"default"],[107,41,72,31],[107,42,72,32,"info"],[107,46,72,36],[107,47,72,37],[107,48,72,38],[108,8,73,6],[108,9,73,7],[109,8,74,6],[109,14,74,12,"failure"],[109,21,74,19],[109,24,74,22,"failure"],[109,25,74,23,"type"],[109,29,74,27],[109,31,74,29,"message"],[109,38,74,36],[109,43,74,41],[110,10,75,8],[110,14,75,12,"error"],[110,19,75,17],[111,10,76,8],[111,18,76,16,"type"],[111,22,76,20],[112,12,77,10],[112,17,77,15],[112,28,77,26],[113,14,78,12,"error"],[113,19,78,17],[113,22,78,20],[113,26,78,24,"TypeError"],[113,35,78,33],[113,36,78,34,"message"],[113,43,78,41],[113,44,78,42],[114,14,79,12],[115,10,80,8],[116,10,81,8],[116,14,81,12],[116,15,81,13,"error"],[116,20,81,18],[116,22,81,20],[117,12,82,10,"error"],[117,17,82,15],[117,20,82,18],[117,24,82,22,"MediaStreamError"],[117,40,82,38],[117,41,82,38,"default"],[117,48,82,38],[117,49,82,39],[118,14,83,12,"message"],[118,21,83,19],[119,14,84,12,"name"],[119,18,84,16],[119,20,84,18,"type"],[120,12,85,10],[120,13,85,11],[120,14,85,12],[121,10,86,8],[122,10,87,8,"reject"],[122,16,87,14],[122,17,87,15,"error"],[122,22,87,20],[122,23,87,21],[123,8,88,6],[123,9,88,7],[124,8,89,6,"WebRTCModule"],[124,20,89,18],[124,21,89,19,"getUserMedia"],[124,33,89,31],[124,34,89,32,"constraints"],[124,45,89,43],[124,47,89,45,"success"],[124,54,89,52],[124,56,89,54,"failure"],[124,63,89,61],[124,64,89,62],[125,6,90,4],[125,7,90,5],[125,8,90,6],[126,4,91,2],[126,5,91,3],[126,6,91,4],[127,2,92,0],[128,0,92,1],[128,3]],"functionMap":{"names":["<global>","getUserMedia","Promise$argument_0","Promise.all.then$argument_0","success","failure"],"mappings":"AAA;eCU;qBC8B;qCCC;sBCiB;ODc;sBEC;OFc;KDE;GDC;CDC"},"hasCjsExports":false},"type":"js/module"}]}
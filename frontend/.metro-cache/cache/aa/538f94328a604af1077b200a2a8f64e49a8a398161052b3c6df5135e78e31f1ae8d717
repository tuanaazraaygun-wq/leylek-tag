{"dependencies":[{"name":"ts-interface-checker","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":7,"column":26,"index":146},"end":{"line":7,"column":57,"index":177}}],"key":"WhQJtygyJv0EthyrkFHm+3q7knI=","exportNames":["*"],"imports":1}},{"name":"../AgoraBase","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":8,"column":17,"index":196},"end":{"line":8,"column":40,"index":219}}],"key":"cbym8bysWLhD9mhMiwRMn6NuhDY=","exportNames":["*"],"imports":1}},{"name":"../impl/IAgoraMediaRecorderImpl","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":9,"column":31,"index":252},"end":{"line":9,"column":73,"index":294}}],"key":"zBCUoWeDzbvT1VzB/29ZdCGv4CE=","exportNames":["*"],"imports":1}},{"name":"../ti/AgoraMediaBase-ti","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":10,"column":47,"index":343},"end":{"line":10,"column":81,"index":377}}],"key":"NkQV/1vTCXvTNfaEet8OLN0Xf3Q=","exportNames":["*"],"imports":1}},{"name":"./IrisApiEngine","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":11,"column":21,"index":401},"end":{"line":11,"column":47,"index":427}}],"key":"H/eQ0WmsmmlRp60ju6NQ0EEgBFs=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.MediaRecorderInternal = void 0;\n  var _tsInterfaceChecker = require(_dependencyMap[0], \"ts-interface-checker\");\n  var _AgoraBase = require(_dependencyMap[1], \"../AgoraBase\");\n  var _IAgoraMediaRecorderImpl = require(_dependencyMap[2], \"../impl/IAgoraMediaRecorderImpl\");\n  var _AgoraMediaBaseTi = _interopRequireDefault(require(_dependencyMap[3], \"../ti/AgoraMediaBase-ti\"));\n  var _IrisApiEngine = require(_dependencyMap[4], \"./IrisApiEngine\");\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n      default: obj\n    };\n  }\n  const checkers = (0, _tsInterfaceChecker.createCheckers)(_AgoraMediaBaseTi.default);\n  class MediaRecorderInternal extends _IAgoraMediaRecorderImpl.IMediaRecorderImpl {\n    static _observers = new Map();\n    constructor(nativeHandle) {\n      super();\n      this._nativeHandle = nativeHandle;\n    }\n    release() {\n      MediaRecorderInternal._observers.delete(this._nativeHandle);\n      this.removeAllListeners();\n    }\n    get nativeHandle() {\n      return this._nativeHandle;\n    }\n    setMediaRecorderObserver(callback) {\n      const key = this._nativeHandle;\n      if (MediaRecorderInternal._observers.has(key)) {\n        return _AgoraBase.ErrorCodeType.ErrOk;\n      }\n      MediaRecorderInternal._observers.set(key, callback);\n      return super.setMediaRecorderObserver(callback);\n    }\n    _addListenerPreCheck(eventType) {\n      var _checkers$IMediaRecor;\n      if ((_checkers$IMediaRecor = checkers.IMediaRecorderObserver) !== null && _checkers$IMediaRecor !== void 0 && _checkers$IMediaRecor.strictTest({\n        [eventType]: undefined\n      })) {\n        if (MediaRecorderInternal._observers.get(this._nativeHandle) === undefined) {\n          this.setMediaRecorderObserver({});\n        }\n      }\n      return true;\n    }\n    addListener(eventType, listener) {\n      this._addListenerPreCheck(eventType);\n      const callback = (eventProcessor, data) => {\n        if (eventProcessor.type(data) !== _IrisApiEngine.EVENT_TYPE.IMediaRecorder) {\n          return;\n        }\n        if (data.nativeHandle !== this._nativeHandle) {\n          return;\n        }\n        eventProcessor.func.map(it => {\n          it({\n            [eventType]: listener\n          }, eventType, data);\n        });\n      };\n      // @ts-ignore\n      listener.agoraCallback = callback;\n      _IrisApiEngine.DeviceEventEmitter.addListener(eventType, callback);\n    }\n    removeListener(eventType, listener) {\n      _IrisApiEngine.DeviceEventEmitter.removeListener(eventType,\n      // @ts-ignore\n      (listener === null || listener === void 0 ? void 0 : listener.agoraCallback) ?? listener);\n    }\n    removeAllListeners(eventType) {\n      _IrisApiEngine.DeviceEventEmitter.removeAllListeners(eventType);\n    }\n  }\n  exports.MediaRecorderInternal = MediaRecorderInternal;\n});","lineCount":80,"map":[[2,2,1,0],[2,14,1,12],[4,2,3,0,"Object"],[4,8,3,6],[4,9,3,7,"defineProperty"],[4,23,3,21],[4,24,3,22,"exports"],[4,31,3,29],[4,33,3,31],[4,45,3,43],[4,47,3,45],[5,4,4,2,"value"],[5,9,4,7],[5,11,4,9],[6,2,5,0],[6,3,5,1],[6,4,5,2],[7,2,6,0,"exports"],[7,9,6,7],[7,10,6,8,"MediaRecorderInternal"],[7,31,6,29],[7,34,6,32],[7,39,6,37],[7,40,6,38],[8,2,7,0],[8,6,7,4,"_tsInterfaceChecker"],[8,25,7,23],[8,28,7,26,"require"],[8,35,7,33],[8,36,7,33,"_dependencyMap"],[8,50,7,33],[8,77,7,56],[8,78,7,57],[9,2,8,0],[9,6,8,4,"_AgoraBase"],[9,16,8,14],[9,19,8,17,"require"],[9,26,8,24],[9,27,8,24,"_dependencyMap"],[9,41,8,24],[9,60,8,39],[9,61,8,40],[10,2,9,0],[10,6,9,4,"_IAgoraMediaRecorderImpl"],[10,30,9,28],[10,33,9,31,"require"],[10,40,9,38],[10,41,9,38,"_dependencyMap"],[10,55,9,38],[10,93,9,72],[10,94,9,73],[11,2,10,0],[11,6,10,4,"_AgoraMediaBaseTi"],[11,23,10,21],[11,26,10,24,"_interopRequireDefault"],[11,48,10,46],[11,49,10,47,"require"],[11,56,10,54],[11,57,10,54,"_dependencyMap"],[11,71,10,54],[11,101,10,80],[11,102,10,81],[11,103,10,82],[12,2,11,0],[12,6,11,4,"_IrisApiEngine"],[12,20,11,18],[12,23,11,21,"require"],[12,30,11,28],[12,31,11,28,"_dependencyMap"],[12,45,11,28],[12,67,11,46],[12,68,11,47],[13,2,12,0],[13,11,12,9,"_interopRequireDefault"],[13,33,12,31,"_interopRequireDefault"],[13,34,12,32,"obj"],[13,37,12,35],[13,39,12,37],[14,4,12,39],[14,11,12,46,"obj"],[14,14,12,49],[14,18,12,53,"obj"],[14,21,12,56],[14,22,12,57,"__esModule"],[14,32,12,67],[14,35,12,70,"obj"],[14,38,12,73],[14,41,12,76],[15,6,12,78,"default"],[15,13,12,85],[15,15,12,87,"obj"],[16,4,12,91],[16,5,12,92],[17,2,12,94],[18,2,13,0],[18,8,13,6,"checkers"],[18,16,13,14],[18,19,13,17],[18,20,13,18],[18,21,13,19],[18,23,13,21,"_tsInterfaceChecker"],[18,42,13,40],[18,43,13,41,"createCheckers"],[18,57,13,55],[18,59,13,57,"_AgoraMediaBaseTi"],[18,76,13,74],[18,77,13,75,"default"],[18,84,13,82],[18,85,13,83],[19,2,14,0],[19,8,14,6,"MediaRecorderInternal"],[19,29,14,27],[19,38,14,36,"_IAgoraMediaRecorderImpl"],[19,62,14,60],[19,63,14,61,"IMediaRecorderImpl"],[19,81,14,79],[19,82,14,80],[20,4,15,2],[20,11,15,9,"_observers"],[20,21,15,19],[20,24,15,22],[20,28,15,26,"Map"],[20,31,15,29],[20,32,15,30],[20,33,15,31],[21,4,16,2,"constructor"],[21,15,16,13,"constructor"],[21,16,16,14,"nativeHandle"],[21,28,16,26],[21,30,16,28],[22,6,17,4],[22,11,17,9],[22,12,17,10],[22,13,17,11],[23,6,18,4],[23,10,18,8],[23,11,18,9,"_nativeHandle"],[23,24,18,22],[23,27,18,25,"nativeHandle"],[23,39,18,37],[24,4,19,2],[25,4,20,2,"release"],[25,11,20,9,"release"],[25,12,20,9],[25,14,20,12],[26,6,21,4,"MediaRecorderInternal"],[26,27,21,25],[26,28,21,26,"_observers"],[26,38,21,36],[26,39,21,37,"delete"],[26,45,21,43],[26,46,21,44],[26,50,21,48],[26,51,21,49,"_nativeHandle"],[26,64,21,62],[26,65,21,63],[27,6,22,4],[27,10,22,8],[27,11,22,9,"removeAllListeners"],[27,29,22,27],[27,30,22,28],[27,31,22,29],[28,4,23,2],[29,4,24,2],[29,8,24,6,"nativeHandle"],[29,20,24,18,"nativeHandle"],[29,21,24,18],[29,23,24,21],[30,6,25,4],[30,13,25,11],[30,17,25,15],[30,18,25,16,"_nativeHandle"],[30,31,25,29],[31,4,26,2],[32,4,27,2,"setMediaRecorderObserver"],[32,28,27,26,"setMediaRecorderObserver"],[32,29,27,27,"callback"],[32,37,27,35],[32,39,27,37],[33,6,28,4],[33,12,28,10,"key"],[33,15,28,13],[33,18,28,16],[33,22,28,20],[33,23,28,21,"_nativeHandle"],[33,36,28,34],[34,6,29,4],[34,10,29,8,"MediaRecorderInternal"],[34,31,29,29],[34,32,29,30,"_observers"],[34,42,29,40],[34,43,29,41,"has"],[34,46,29,44],[34,47,29,45,"key"],[34,50,29,48],[34,51,29,49],[34,53,29,51],[35,8,30,6],[35,15,30,13,"_AgoraBase"],[35,25,30,23],[35,26,30,24,"ErrorCodeType"],[35,39,30,37],[35,40,30,38,"ErrOk"],[35,45,30,43],[36,6,31,4],[37,6,32,4,"MediaRecorderInternal"],[37,27,32,25],[37,28,32,26,"_observers"],[37,38,32,36],[37,39,32,37,"set"],[37,42,32,40],[37,43,32,41,"key"],[37,46,32,44],[37,48,32,46,"callback"],[37,56,32,54],[37,57,32,55],[38,6,33,4],[38,13,33,11],[38,18,33,16],[38,19,33,17,"setMediaRecorderObserver"],[38,43,33,41],[38,44,33,42,"callback"],[38,52,33,50],[38,53,33,51],[39,4,34,2],[40,4,35,2,"_addListenerPreCheck"],[40,24,35,22,"_addListenerPreCheck"],[40,25,35,23,"eventType"],[40,34,35,32],[40,36,35,34],[41,6,36,4],[41,10,36,8,"_checkers$IMediaRecor"],[41,31,36,29],[42,6,37,4],[42,10,37,8],[42,11,37,9,"_checkers$IMediaRecor"],[42,32,37,30],[42,35,37,33,"checkers"],[42,43,37,41],[42,44,37,42,"IMediaRecorderObserver"],[42,66,37,64],[42,72,37,70],[42,76,37,74],[42,80,37,78,"_checkers$IMediaRecor"],[42,101,37,99],[42,106,37,104],[42,111,37,109],[42,112,37,110],[42,116,37,114,"_checkers$IMediaRecor"],[42,137,37,135],[42,138,37,136,"strictTest"],[42,148,37,146],[42,149,37,147],[43,8,38,6],[43,9,38,7,"eventType"],[43,18,38,16],[43,21,38,19,"undefined"],[44,6,39,4],[44,7,39,5],[44,8,39,6],[44,10,39,8],[45,8,40,6],[45,12,40,10,"MediaRecorderInternal"],[45,33,40,31],[45,34,40,32,"_observers"],[45,44,40,42],[45,45,40,43,"get"],[45,48,40,46],[45,49,40,47],[45,53,40,51],[45,54,40,52,"_nativeHandle"],[45,67,40,65],[45,68,40,66],[45,73,40,71,"undefined"],[45,82,40,80],[45,84,40,82],[46,10,41,8],[46,14,41,12],[46,15,41,13,"setMediaRecorderObserver"],[46,39,41,37],[46,40,41,38],[46,41,41,39],[46,42,41,40],[46,43,41,41],[47,8,42,6],[48,6,43,4],[49,6,44,4],[49,13,44,11],[49,17,44,15],[50,4,45,2],[51,4,46,2,"addListener"],[51,15,46,13,"addListener"],[51,16,46,14,"eventType"],[51,25,46,23],[51,27,46,25,"listener"],[51,35,46,33],[51,37,46,35],[52,6,47,4],[52,10,47,8],[52,11,47,9,"_addListenerPreCheck"],[52,31,47,29],[52,32,47,30,"eventType"],[52,41,47,39],[52,42,47,40],[53,6,48,4],[53,12,48,10,"callback"],[53,20,48,18],[53,23,48,21,"callback"],[53,24,48,22,"eventProcessor"],[53,38,48,36],[53,40,48,38,"data"],[53,44,48,42],[53,49,48,47],[54,8,49,6],[54,12,49,10,"eventProcessor"],[54,26,49,24],[54,27,49,25,"type"],[54,31,49,29],[54,32,49,30,"data"],[54,36,49,34],[54,37,49,35],[54,42,49,40,"_IrisApiEngine"],[54,56,49,54],[54,57,49,55,"EVENT_TYPE"],[54,67,49,65],[54,68,49,66,"IMediaRecorder"],[54,82,49,80],[54,84,49,82],[55,10,50,8],[56,8,51,6],[57,8,52,6],[57,12,52,10,"data"],[57,16,52,14],[57,17,52,15,"nativeHandle"],[57,29,52,27],[57,34,52,32],[57,38,52,36],[57,39,52,37,"_nativeHandle"],[57,52,52,50],[57,54,52,52],[58,10,53,8],[59,8,54,6],[60,8,55,6,"eventProcessor"],[60,22,55,20],[60,23,55,21,"func"],[60,27,55,25],[60,28,55,26,"map"],[60,31,55,29],[60,32,55,30,"it"],[60,34,55,32],[60,38,55,36],[61,10,56,8,"it"],[61,12,56,10],[61,13,56,11],[62,12,57,10],[62,13,57,11,"eventType"],[62,22,57,20],[62,25,57,23,"listener"],[63,10,58,8],[63,11,58,9],[63,13,58,11,"eventType"],[63,22,58,20],[63,24,58,22,"data"],[63,28,58,26],[63,29,58,27],[64,8,59,6],[64,9,59,7],[64,10,59,8],[65,6,60,4],[65,7,60,5],[66,6,61,4],[67,6,62,4,"listener"],[67,14,62,12],[67,15,62,13,"agoraCallback"],[67,28,62,26],[67,31,62,29,"callback"],[67,39,62,37],[68,6,63,4,"_IrisApiEngine"],[68,20,63,18],[68,21,63,19,"DeviceEventEmitter"],[68,39,63,37],[68,40,63,38,"addListener"],[68,51,63,49],[68,52,63,50,"eventType"],[68,61,63,59],[68,63,63,61,"callback"],[68,71,63,69],[68,72,63,70],[69,4,64,2],[70,4,65,2,"removeListener"],[70,18,65,16,"removeListener"],[70,19,65,17,"eventType"],[70,28,65,26],[70,30,65,28,"listener"],[70,38,65,36],[70,40,65,38],[71,6,66,4,"_IrisApiEngine"],[71,20,66,18],[71,21,66,19,"DeviceEventEmitter"],[71,39,66,37],[71,40,66,38,"removeListener"],[71,54,66,52],[71,55,66,53,"eventType"],[71,64,66,62],[72,6,67,4],[73,6,68,4],[73,7,68,5,"listener"],[73,15,68,13],[73,20,68,18],[73,24,68,22],[73,28,68,26,"listener"],[73,36,68,34],[73,41,68,39],[73,46,68,44],[73,47,68,45],[73,50,68,48],[73,55,68,53],[73,56,68,54],[73,59,68,57,"listener"],[73,67,68,65],[73,68,68,66,"agoraCallback"],[73,81,68,79],[73,86,68,84,"listener"],[73,94,68,92],[73,95,68,93],[74,4,69,2],[75,4,70,2,"removeAllListeners"],[75,22,70,20,"removeAllListeners"],[75,23,70,21,"eventType"],[75,32,70,30],[75,34,70,32],[76,6,71,4,"_IrisApiEngine"],[76,20,71,18],[76,21,71,19,"DeviceEventEmitter"],[76,39,71,37],[76,40,71,38,"removeAllListeners"],[76,58,71,56],[76,59,71,57,"eventType"],[76,68,71,66],[76,69,71,67],[77,4,72,2],[78,2,73,0],[79,2,74,0,"exports"],[79,9,74,7],[79,10,74,8,"MediaRecorderInternal"],[79,31,74,29],[79,34,74,32,"MediaRecorderInternal"],[79,55,74,53],[80,0,74,54],[80,3]],"functionMap":{"names":["<global>","_interopRequireDefault","MediaRecorderInternal","constructor","release","get__nativeHandle","setMediaRecorderObserver","_addListenerPreCheck","addListener","callback","eventProcessor.func.map$argument_0","removeListener","removeAllListeners"],"mappings":"AAA;ACW,+FD;AEE;ECE;GDG;EEC;GFG;EGC;GHE;EIC;GJO;EKC;GLU;EMC;qBCE;8BCO;ODI;KDC;GNI;ESC;GTI;EUC;GVE;CFC"},"hasCjsExports":true},"type":"js/module"}]}
{"dependencies":[{"name":"@babel/runtime/helpers/classCallCheck","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"yg7e6laZwmpbIvId5jovq9ugXp8=","exportNames":["*"],"imports":1}},{"name":"@babel/runtime/helpers/createClass","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"Z6pzkVZ2fvxBLkFTgVVOy4UDj30=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  /*\n    This file draws heavily from https://github.com/phoenixframework/phoenix/blob/d344ec0a732ab4ee204215b31de69cf4be72e3bf/assets/js/phoenix/presence.js\n    License: https://github.com/phoenixframework/phoenix/blob/d344ec0a732ab4ee204215b31de69cf4be72e3bf/LICENSE.md\n  */\n  var _classCallCheck = require(_dependencyMap[0]).default;\n  var _createClass = require(_dependencyMap[1]).default;\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.REALTIME_PRESENCE_LISTEN_EVENTS = undefined;\n  var REALTIME_PRESENCE_LISTEN_EVENTS;\n  (function (REALTIME_PRESENCE_LISTEN_EVENTS) {\n    REALTIME_PRESENCE_LISTEN_EVENTS[\"SYNC\"] = \"sync\";\n    REALTIME_PRESENCE_LISTEN_EVENTS[\"JOIN\"] = \"join\";\n    REALTIME_PRESENCE_LISTEN_EVENTS[\"LEAVE\"] = \"leave\";\n  })(REALTIME_PRESENCE_LISTEN_EVENTS || (exports.REALTIME_PRESENCE_LISTEN_EVENTS = REALTIME_PRESENCE_LISTEN_EVENTS = {}));\n  var RealtimePresence = /*#__PURE__*/function () {\n    /**\n     * Creates a Presence helper that keeps the local presence state in sync with the server.\n     *\n     * @param channel - The realtime channel to bind to.\n     * @param opts - Optional custom event names, e.g. `{ events: { state: 'state', diff: 'diff' } }`.\n     *\n     * @example\n     * ```ts\n     * const presence = new RealtimePresence(channel)\n     *\n     * channel.on('presence', ({ event, key }) => {\n     *   console.log(`Presence ${event} on ${key}`)\n     * })\n     * ```\n     */\n    function RealtimePresence(channel, opts) {\n      _classCallCheck(this, RealtimePresence);\n      this.channel = channel;\n      this.state = {};\n      this.pendingDiffs = [];\n      this.joinRef = null;\n      this.enabled = false;\n      this.caller = {\n        onJoin: () => {},\n        onLeave: () => {},\n        onSync: () => {}\n      };\n      var events = (opts === null || opts === undefined ? undefined : opts.events) || {\n        state: 'presence_state',\n        diff: 'presence_diff'\n      };\n      this.channel._on(events.state, {}, newState => {\n        var _this$caller = this.caller,\n          onJoin = _this$caller.onJoin,\n          onLeave = _this$caller.onLeave,\n          onSync = _this$caller.onSync;\n        this.joinRef = this.channel._joinRef();\n        this.state = RealtimePresence.syncState(this.state, newState, onJoin, onLeave);\n        this.pendingDiffs.forEach(diff => {\n          this.state = RealtimePresence.syncDiff(this.state, diff, onJoin, onLeave);\n        });\n        this.pendingDiffs = [];\n        onSync();\n      });\n      this.channel._on(events.diff, {}, diff => {\n        var _this$caller2 = this.caller,\n          onJoin = _this$caller2.onJoin,\n          onLeave = _this$caller2.onLeave,\n          onSync = _this$caller2.onSync;\n        if (this.inPendingSyncState()) {\n          this.pendingDiffs.push(diff);\n        } else {\n          this.state = RealtimePresence.syncDiff(this.state, diff, onJoin, onLeave);\n          onSync();\n        }\n      });\n      this.onJoin((key, currentPresences, newPresences) => {\n        this.channel._trigger('presence', {\n          event: 'join',\n          key,\n          currentPresences,\n          newPresences\n        });\n      });\n      this.onLeave((key, currentPresences, leftPresences) => {\n        this.channel._trigger('presence', {\n          event: 'leave',\n          key,\n          currentPresences,\n          leftPresences\n        });\n      });\n      this.onSync(() => {\n        this.channel._trigger('presence', {\n          event: 'sync'\n        });\n      });\n    }\n    /**\n     * Used to sync the list of presences on the server with the\n     * client's state.\n     *\n     * An optional `onJoin` and `onLeave` callback can be provided to\n     * react to changes in the client's local presences across\n     * disconnects and reconnects with the server.\n     *\n     * @internal\n     */\n    return _createClass(RealtimePresence, [{\n      key: \"onJoin\",\n      value: /** @internal */\n      function onJoin(callback) {\n        this.caller.onJoin = callback;\n      }\n      /** @internal */\n    }, {\n      key: \"onLeave\",\n      value: function onLeave(callback) {\n        this.caller.onLeave = callback;\n      }\n      /** @internal */\n    }, {\n      key: \"onSync\",\n      value: function onSync(callback) {\n        this.caller.onSync = callback;\n      }\n      /** @internal */\n    }, {\n      key: \"inPendingSyncState\",\n      value: function inPendingSyncState() {\n        return !this.joinRef || this.joinRef !== this.channel._joinRef();\n      }\n    }], [{\n      key: \"syncState\",\n      value: function syncState(currentState, newState, onJoin, onLeave) {\n        var state = this.cloneDeep(currentState);\n        var transformedState = this.transformState(newState);\n        var joins = {};\n        var leaves = {};\n        this.map(state, (key, presences) => {\n          if (!transformedState[key]) {\n            leaves[key] = presences;\n          }\n        });\n        this.map(transformedState, (key, newPresences) => {\n          var currentPresences = state[key];\n          if (currentPresences) {\n            var newPresenceRefs = newPresences.map(m => m.presence_ref);\n            var curPresenceRefs = currentPresences.map(m => m.presence_ref);\n            var joinedPresences = newPresences.filter(m => curPresenceRefs.indexOf(m.presence_ref) < 0);\n            var leftPresences = currentPresences.filter(m => newPresenceRefs.indexOf(m.presence_ref) < 0);\n            if (joinedPresences.length > 0) {\n              joins[key] = joinedPresences;\n            }\n            if (leftPresences.length > 0) {\n              leaves[key] = leftPresences;\n            }\n          } else {\n            joins[key] = newPresences;\n          }\n        });\n        return this.syncDiff(state, {\n          joins,\n          leaves\n        }, onJoin, onLeave);\n      }\n      /**\n       * Used to sync a diff of presence join and leave events from the\n       * server, as they happen.\n       *\n       * Like `syncState`, `syncDiff` accepts optional `onJoin` and\n       * `onLeave` callbacks to react to a user joining or leaving from a\n       * device.\n       *\n       * @internal\n       */\n    }, {\n      key: \"syncDiff\",\n      value: function syncDiff(state, diff, onJoin, onLeave) {\n        var _joins$leaves = {\n            joins: this.transformState(diff.joins),\n            leaves: this.transformState(diff.leaves)\n          },\n          joins = _joins$leaves.joins,\n          leaves = _joins$leaves.leaves;\n        if (!onJoin) {\n          onJoin = () => {};\n        }\n        if (!onLeave) {\n          onLeave = () => {};\n        }\n        this.map(joins, (key, newPresences) => {\n          var _a;\n          var currentPresences = (_a = state[key]) !== null && _a !== undefined ? _a : [];\n          state[key] = this.cloneDeep(newPresences);\n          if (currentPresences.length > 0) {\n            var joinedPresenceRefs = state[key].map(m => m.presence_ref);\n            var curPresences = currentPresences.filter(m => joinedPresenceRefs.indexOf(m.presence_ref) < 0);\n            state[key].unshift(...curPresences);\n          }\n          onJoin(key, currentPresences, newPresences);\n        });\n        this.map(leaves, (key, leftPresences) => {\n          var currentPresences = state[key];\n          if (!currentPresences) return;\n          var presenceRefsToRemove = leftPresences.map(m => m.presence_ref);\n          currentPresences = currentPresences.filter(m => presenceRefsToRemove.indexOf(m.presence_ref) < 0);\n          state[key] = currentPresences;\n          onLeave(key, currentPresences, leftPresences);\n          if (currentPresences.length === 0) delete state[key];\n        });\n        return state;\n      }\n      /** @internal */\n    }, {\n      key: \"map\",\n      value: function map(obj, func) {\n        return Object.getOwnPropertyNames(obj).map(key => func(key, obj[key]));\n      }\n      /**\n       * Remove 'metas' key\n       * Change 'phx_ref' to 'presence_ref'\n       * Remove 'phx_ref' and 'phx_ref_prev'\n       *\n       * @example\n       * // returns {\n       *  abc123: [\n       *    { presence_ref: '2', user_id: 1 },\n       *    { presence_ref: '3', user_id: 2 }\n       *  ]\n       * }\n       * RealtimePresence.transformState({\n       *  abc123: {\n       *    metas: [\n       *      { phx_ref: '2', phx_ref_prev: '1' user_id: 1 },\n       *      { phx_ref: '3', user_id: 2 }\n       *    ]\n       *  }\n       * })\n       *\n       * @internal\n       */\n    }, {\n      key: \"transformState\",\n      value: function transformState(state) {\n        state = this.cloneDeep(state);\n        return Object.getOwnPropertyNames(state).reduce((newState, key) => {\n          var presences = state[key];\n          if ('metas' in presences) {\n            newState[key] = presences.metas.map(presence => {\n              presence['presence_ref'] = presence['phx_ref'];\n              delete presence['phx_ref'];\n              delete presence['phx_ref_prev'];\n              return presence;\n            });\n          } else {\n            newState[key] = presences;\n          }\n          return newState;\n        }, {});\n      }\n      /** @internal */\n    }, {\n      key: \"cloneDeep\",\n      value: function cloneDeep(obj) {\n        return JSON.parse(JSON.stringify(obj));\n      }\n    }]);\n  }();\n  exports.default = RealtimePresence;\n});","lineCount":271,"map":[[2,2,1,0],[2,14,1,12],[4,2,2,0],[5,0,3,0],[6,0,4,0],[7,0,5,0],[8,2,2,0],[8,6,2,0,"_classCallCheck"],[8,21,2,0],[8,24,2,0,"require"],[8,31,2,0],[8,32,2,0,"_dependencyMap"],[8,46,2,0],[8,51,2,0,"default"],[8,58,2,0],[9,2,2,0],[9,6,2,0,"_createClass"],[9,18,2,0],[9,21,2,0,"require"],[9,28,2,0],[9,29,2,0,"_dependencyMap"],[9,43,2,0],[9,48,2,0,"default"],[9,55,2,0],[10,2,6,0,"Object"],[10,8,6,6],[10,9,6,7,"defineProperty"],[10,23,6,21],[10,24,6,22,"exports"],[10,31,6,29],[10,33,6,31],[10,45,6,43],[10,47,6,45],[11,4,6,47,"value"],[11,9,6,52],[11,11,6,54],[12,2,6,59],[12,3,6,60],[12,4,6,61],[13,2,7,0,"exports"],[13,9,7,7],[13,10,7,8,"REALTIME_PRESENCE_LISTEN_EVENTS"],[13,41,7,39],[13,44,7,39,"undefined"],[13,53,7,48],[14,2,8,0],[14,6,8,4,"REALTIME_PRESENCE_LISTEN_EVENTS"],[14,37,8,35],[15,2,9,0],[15,3,9,1],[15,13,9,11,"REALTIME_PRESENCE_LISTEN_EVENTS"],[15,44,9,42],[15,46,9,44],[16,4,10,4,"REALTIME_PRESENCE_LISTEN_EVENTS"],[16,35,10,35],[16,36,10,36],[16,42,10,42],[16,43,10,43],[16,46,10,46],[16,52,10,52],[17,4,11,4,"REALTIME_PRESENCE_LISTEN_EVENTS"],[17,35,11,35],[17,36,11,36],[17,42,11,42],[17,43,11,43],[17,46,11,46],[17,52,11,52],[18,4,12,4,"REALTIME_PRESENCE_LISTEN_EVENTS"],[18,35,12,35],[18,36,12,36],[18,43,12,43],[18,44,12,44],[18,47,12,47],[18,54,12,54],[19,2,13,0],[19,3,13,1],[19,5,13,3,"REALTIME_PRESENCE_LISTEN_EVENTS"],[19,36,13,34],[19,41,13,39,"exports"],[19,48,13,46],[19,49,13,47,"REALTIME_PRESENCE_LISTEN_EVENTS"],[19,80,13,78],[19,83,13,81,"REALTIME_PRESENCE_LISTEN_EVENTS"],[19,114,13,112],[19,117,13,115],[19,118,13,116],[19,119,13,117],[19,120,13,118],[19,121,13,119],[20,2,13,120],[20,6,14,6,"RealtimePresence"],[20,22,14,22],[21,4,15,4],[22,0,16,0],[23,0,17,0],[24,0,18,0],[25,0,19,0],[26,0,20,0],[27,0,21,0],[28,0,22,0],[29,0,23,0],[30,0,24,0],[31,0,25,0],[32,0,26,0],[33,0,27,0],[34,0,28,0],[35,0,29,0],[36,4,30,4],[36,13,30,4,"RealtimePresence"],[36,30,30,16,"channel"],[36,37,30,23],[36,39,30,25,"opts"],[36,43,30,29],[36,45,30,31],[37,6,30,31,"_classCallCheck"],[37,21,30,31],[37,28,30,31,"RealtimePresence"],[37,44,30,31],[38,6,31,8],[38,10,31,12],[38,11,31,13,"channel"],[38,18,31,20],[38,21,31,23,"channel"],[38,28,31,30],[39,6,32,8],[39,10,32,12],[39,11,32,13,"state"],[39,16,32,18],[39,19,32,21],[39,20,32,22],[39,21,32,23],[40,6,33,8],[40,10,33,12],[40,11,33,13,"pendingDiffs"],[40,23,33,25],[40,26,33,28],[40,28,33,30],[41,6,34,8],[41,10,34,12],[41,11,34,13,"joinRef"],[41,18,34,20],[41,21,34,23],[41,25,34,27],[42,6,35,8],[42,10,35,12],[42,11,35,13,"enabled"],[42,18,35,20],[42,21,35,23],[42,26,35,28],[43,6,36,8],[43,10,36,12],[43,11,36,13,"caller"],[43,17,36,19],[43,20,36,22],[44,8,37,12,"onJoin"],[44,14,37,18],[44,16,37,20,"onJoin"],[44,17,37,20],[44,22,37,26],[44,23,37,28],[44,24,37,29],[45,8,38,12,"onLeave"],[45,15,38,19],[45,17,38,21,"onLeave"],[45,18,38,21],[45,23,38,27],[45,24,38,29],[45,25,38,30],[46,8,39,12,"onSync"],[46,14,39,18],[46,16,39,20,"onSync"],[46,17,39,20],[46,22,39,26],[46,23,39,28],[47,6,40,8],[47,7,40,9],[48,6,41,8],[48,10,41,14,"events"],[48,16,41,20],[48,19,41,23],[48,20,41,24,"opts"],[48,24,41,28],[48,29,41,33],[48,33,41,37],[48,37,41,41,"opts"],[48,41,41,45],[48,46,41,45,"undefined"],[48,55,41,56],[48,58,41,56,"undefined"],[48,67,41,56],[48,70,41,68,"opts"],[48,74,41,72],[48,75,41,73,"events"],[48,81,41,79],[48,86,41,84],[49,8,42,12,"state"],[49,13,42,17],[49,15,42,19],[49,31,42,35],[50,8,43,12,"diff"],[50,12,43,16],[50,14,43,18],[51,6,44,8],[51,7,44,9],[52,6,45,8],[52,10,45,12],[52,11,45,13,"channel"],[52,18,45,20],[52,19,45,21,"_on"],[52,22,45,24],[52,23,45,25,"events"],[52,29,45,31],[52,30,45,32,"state"],[52,35,45,37],[52,37,45,39],[52,38,45,40],[52,39,45,41],[52,41,45,44,"newState"],[52,49,45,52],[52,53,45,57],[53,8,46,12],[53,12,46,12,"_this$caller"],[53,24,46,12],[53,27,46,48],[53,31,46,52],[53,32,46,53,"caller"],[53,38,46,59],[54,10,46,20,"onJoin"],[54,16,46,26],[54,19,46,26,"_this$caller"],[54,31,46,26],[54,32,46,20,"onJoin"],[54,38,46,26],[55,10,46,28,"onLeave"],[55,17,46,35],[55,20,46,35,"_this$caller"],[55,32,46,35],[55,33,46,28,"onLeave"],[55,40,46,35],[56,10,46,37,"onSync"],[56,16,46,43],[56,19,46,43,"_this$caller"],[56,31,46,43],[56,32,46,37,"onSync"],[56,38,46,43],[57,8,47,12],[57,12,47,16],[57,13,47,17,"joinRef"],[57,20,47,24],[57,23,47,27],[57,27,47,31],[57,28,47,32,"channel"],[57,35,47,39],[57,36,47,40,"_joinRef"],[57,44,47,48],[57,45,47,49],[57,46,47,50],[58,8,48,12],[58,12,48,16],[58,13,48,17,"state"],[58,18,48,22],[58,21,48,25,"RealtimePresence"],[58,37,48,41],[58,38,48,42,"syncState"],[58,47,48,51],[58,48,48,52],[58,52,48,56],[58,53,48,57,"state"],[58,58,48,62],[58,60,48,64,"newState"],[58,68,48,72],[58,70,48,74,"onJoin"],[58,76,48,80],[58,78,48,82,"onLeave"],[58,85,48,89],[58,86,48,90],[59,8,49,12],[59,12,49,16],[59,13,49,17,"pendingDiffs"],[59,25,49,29],[59,26,49,30,"forEach"],[59,33,49,37],[59,34,49,39,"diff"],[59,38,49,43],[59,42,49,48],[60,10,50,16],[60,14,50,20],[60,15,50,21,"state"],[60,20,50,26],[60,23,50,29,"RealtimePresence"],[60,39,50,45],[60,40,50,46,"syncDiff"],[60,48,50,54],[60,49,50,55],[60,53,50,59],[60,54,50,60,"state"],[60,59,50,65],[60,61,50,67,"diff"],[60,65,50,71],[60,67,50,73,"onJoin"],[60,73,50,79],[60,75,50,81,"onLeave"],[60,82,50,88],[60,83,50,89],[61,8,51,12],[61,9,51,13],[61,10,51,14],[62,8,52,12],[62,12,52,16],[62,13,52,17,"pendingDiffs"],[62,25,52,29],[62,28,52,32],[62,30,52,34],[63,8,53,12,"onSync"],[63,14,53,18],[63,15,53,19],[63,16,53,20],[64,6,54,8],[64,7,54,9],[64,8,54,10],[65,6,55,8],[65,10,55,12],[65,11,55,13,"channel"],[65,18,55,20],[65,19,55,21,"_on"],[65,22,55,24],[65,23,55,25,"events"],[65,29,55,31],[65,30,55,32,"diff"],[65,34,55,36],[65,36,55,38],[65,37,55,39],[65,38,55,40],[65,40,55,43,"diff"],[65,44,55,47],[65,48,55,52],[66,8,56,12],[66,12,56,12,"_this$caller2"],[66,25,56,12],[66,28,56,48],[66,32,56,52],[66,33,56,53,"caller"],[66,39,56,59],[67,10,56,20,"onJoin"],[67,16,56,26],[67,19,56,26,"_this$caller2"],[67,32,56,26],[67,33,56,20,"onJoin"],[67,39,56,26],[68,10,56,28,"onLeave"],[68,17,56,35],[68,20,56,35,"_this$caller2"],[68,33,56,35],[68,34,56,28,"onLeave"],[68,41,56,35],[69,10,56,37,"onSync"],[69,16,56,43],[69,19,56,43,"_this$caller2"],[69,32,56,43],[69,33,56,37,"onSync"],[69,39,56,43],[70,8,57,12],[70,12,57,16],[70,16,57,20],[70,17,57,21,"inPendingSyncState"],[70,35,57,39],[70,36,57,40],[70,37,57,41],[70,39,57,43],[71,10,58,16],[71,14,58,20],[71,15,58,21,"pendingDiffs"],[71,27,58,33],[71,28,58,34,"push"],[71,32,58,38],[71,33,58,39,"diff"],[71,37,58,43],[71,38,58,44],[72,8,59,12],[72,9,59,13],[72,15,60,17],[73,10,61,16],[73,14,61,20],[73,15,61,21,"state"],[73,20,61,26],[73,23,61,29,"RealtimePresence"],[73,39,61,45],[73,40,61,46,"syncDiff"],[73,48,61,54],[73,49,61,55],[73,53,61,59],[73,54,61,60,"state"],[73,59,61,65],[73,61,61,67,"diff"],[73,65,61,71],[73,67,61,73,"onJoin"],[73,73,61,79],[73,75,61,81,"onLeave"],[73,82,61,88],[73,83,61,89],[74,10,62,16,"onSync"],[74,16,62,22],[74,17,62,23],[74,18,62,24],[75,8,63,12],[76,6,64,8],[76,7,64,9],[76,8,64,10],[77,6,65,8],[77,10,65,12],[77,11,65,13,"onJoin"],[77,17,65,19],[77,18,65,20],[77,19,65,21,"key"],[77,22,65,24],[77,24,65,26,"currentPresences"],[77,40,65,42],[77,42,65,44,"newPresences"],[77,54,65,56],[77,59,65,61],[78,8,66,12],[78,12,66,16],[78,13,66,17,"channel"],[78,20,66,24],[78,21,66,25,"_trigger"],[78,29,66,33],[78,30,66,34],[78,40,66,44],[78,42,66,46],[79,10,67,16,"event"],[79,15,67,21],[79,17,67,23],[79,23,67,29],[80,10,68,16,"key"],[80,13,68,19],[81,10,69,16,"currentPresences"],[81,26,69,32],[82,10,70,16,"newPresences"],[83,8,71,12],[83,9,71,13],[83,10,71,14],[84,6,72,8],[84,7,72,9],[84,8,72,10],[85,6,73,8],[85,10,73,12],[85,11,73,13,"onLeave"],[85,18,73,20],[85,19,73,21],[85,20,73,22,"key"],[85,23,73,25],[85,25,73,27,"currentPresences"],[85,41,73,43],[85,43,73,45,"leftPresences"],[85,56,73,58],[85,61,73,63],[86,8,74,12],[86,12,74,16],[86,13,74,17,"channel"],[86,20,74,24],[86,21,74,25,"_trigger"],[86,29,74,33],[86,30,74,34],[86,40,74,44],[86,42,74,46],[87,10,75,16,"event"],[87,15,75,21],[87,17,75,23],[87,24,75,30],[88,10,76,16,"key"],[88,13,76,19],[89,10,77,16,"currentPresences"],[89,26,77,32],[90,10,78,16,"leftPresences"],[91,8,79,12],[91,9,79,13],[91,10,79,14],[92,6,80,8],[92,7,80,9],[92,8,80,10],[93,6,81,8],[93,10,81,12],[93,11,81,13,"onSync"],[93,17,81,19],[93,18,81,20],[93,24,81,26],[94,8,82,12],[94,12,82,16],[94,13,82,17,"channel"],[94,20,82,24],[94,21,82,25,"_trigger"],[94,29,82,33],[94,30,82,34],[94,40,82,44],[94,42,82,46],[95,10,82,48,"event"],[95,15,82,53],[95,17,82,55],[96,8,82,62],[96,9,82,63],[96,10,82,64],[97,6,83,8],[97,7,83,9],[97,8,83,10],[98,4,84,4],[99,4,85,4],[100,0,86,0],[101,0,87,0],[102,0,88,0],[103,0,89,0],[104,0,90,0],[105,0,91,0],[106,0,92,0],[107,0,93,0],[108,0,94,0],[109,4,85,4],[109,11,85,4,"_createClass"],[109,23,85,4],[109,24,85,4,"RealtimePresence"],[109,40,85,4],[110,6,85,4,"key"],[110,9,85,4],[111,6,85,4,"value"],[111,11,85,4],[111,13,219,4],[112,6,220,4],[112,15,220,4,"onJoin"],[112,21,220,10,"onJoin"],[112,22,220,11,"callback"],[112,30,220,19],[112,32,220,21],[113,8,221,8],[113,12,221,12],[113,13,221,13,"caller"],[113,19,221,19],[113,20,221,20,"onJoin"],[113,26,221,26],[113,29,221,29,"callback"],[113,37,221,37],[114,6,222,4],[115,6,223,4],[116,4,223,4],[117,6,223,4,"key"],[117,9,223,4],[118,6,223,4,"value"],[118,11,223,4],[118,13,224,4],[118,22,224,4,"onLeave"],[118,29,224,11,"onLeave"],[118,30,224,12,"callback"],[118,38,224,20],[118,40,224,22],[119,8,225,8],[119,12,225,12],[119,13,225,13,"caller"],[119,19,225,19],[119,20,225,20,"onLeave"],[119,27,225,27],[119,30,225,30,"callback"],[119,38,225,38],[120,6,226,4],[121,6,227,4],[122,4,227,4],[123,6,227,4,"key"],[123,9,227,4],[124,6,227,4,"value"],[124,11,227,4],[124,13,228,4],[124,22,228,4,"onSync"],[124,28,228,10,"onSync"],[124,29,228,11,"callback"],[124,37,228,19],[124,39,228,21],[125,8,229,8],[125,12,229,12],[125,13,229,13,"caller"],[125,19,229,19],[125,20,229,20,"onSync"],[125,26,229,26],[125,29,229,29,"callback"],[125,37,229,37],[126,6,230,4],[127,6,231,4],[128,4,231,4],[129,6,231,4,"key"],[129,9,231,4],[130,6,231,4,"value"],[130,11,231,4],[130,13,232,4],[130,22,232,4,"inPendingSyncState"],[130,40,232,22,"inPendingSyncState"],[130,41,232,22],[130,43,232,25],[131,8,233,8],[131,15,233,15],[131,16,233,16],[131,20,233,20],[131,21,233,21,"joinRef"],[131,28,233,28],[131,32,233,32],[131,36,233,36],[131,37,233,37,"joinRef"],[131,44,233,44],[131,49,233,49],[131,53,233,53],[131,54,233,54,"channel"],[131,61,233,61],[131,62,233,62,"_joinRef"],[131,70,233,70],[131,71,233,71],[131,72,233,72],[132,6,234,4],[133,4,234,5],[134,6,234,5,"key"],[134,9,234,5],[135,6,234,5,"value"],[135,11,234,5],[135,13,95,4],[135,22,95,11,"syncState"],[135,31,95,20,"syncState"],[135,32,95,21,"currentState"],[135,44,95,33],[135,46,95,35,"newState"],[135,54,95,43],[135,56,95,45,"onJoin"],[135,62,95,51],[135,64,95,53,"onLeave"],[135,71,95,60],[135,73,95,62],[136,8,96,8],[136,12,96,14,"state"],[136,17,96,19],[136,20,96,22],[136,24,96,26],[136,25,96,27,"cloneDeep"],[136,34,96,36],[136,35,96,37,"currentState"],[136,47,96,49],[136,48,96,50],[137,8,97,8],[137,12,97,14,"transformedState"],[137,28,97,30],[137,31,97,33],[137,35,97,37],[137,36,97,38,"transformState"],[137,50,97,52],[137,51,97,53,"newState"],[137,59,97,61],[137,60,97,62],[138,8,98,8],[138,12,98,14,"joins"],[138,17,98,19],[138,20,98,22],[138,21,98,23],[138,22,98,24],[139,8,99,8],[139,12,99,14,"leaves"],[139,18,99,20],[139,21,99,23],[139,22,99,24],[139,23,99,25],[140,8,100,8],[140,12,100,12],[140,13,100,13,"map"],[140,16,100,16],[140,17,100,17,"state"],[140,22,100,22],[140,24,100,24],[140,25,100,25,"key"],[140,28,100,28],[140,30,100,30,"presences"],[140,39,100,39],[140,44,100,44],[141,10,101,12],[141,14,101,16],[141,15,101,17,"transformedState"],[141,31,101,33],[141,32,101,34,"key"],[141,35,101,37],[141,36,101,38],[141,38,101,40],[142,12,102,16,"leaves"],[142,18,102,22],[142,19,102,23,"key"],[142,22,102,26],[142,23,102,27],[142,26,102,30,"presences"],[142,35,102,39],[143,10,103,12],[144,8,104,8],[144,9,104,9],[144,10,104,10],[145,8,105,8],[145,12,105,12],[145,13,105,13,"map"],[145,16,105,16],[145,17,105,17,"transformedState"],[145,33,105,33],[145,35,105,35],[145,36,105,36,"key"],[145,39,105,39],[145,41,105,41,"newPresences"],[145,53,105,53],[145,58,105,58],[146,10,106,12],[146,14,106,18,"currentPresences"],[146,30,106,34],[146,33,106,37,"state"],[146,38,106,42],[146,39,106,43,"key"],[146,42,106,46],[146,43,106,47],[147,10,107,12],[147,14,107,16,"currentPresences"],[147,30,107,32],[147,32,107,34],[148,12,108,16],[148,16,108,22,"newPresenceRefs"],[148,31,108,37],[148,34,108,40,"newPresences"],[148,46,108,52],[148,47,108,53,"map"],[148,50,108,56],[148,51,108,58,"m"],[148,52,108,59],[148,56,108,64,"m"],[148,57,108,65],[148,58,108,66,"presence_ref"],[148,70,108,78],[148,71,108,79],[149,12,109,16],[149,16,109,22,"curPresenceRefs"],[149,31,109,37],[149,34,109,40,"currentPresences"],[149,50,109,56],[149,51,109,57,"map"],[149,54,109,60],[149,55,109,62,"m"],[149,56,109,63],[149,60,109,68,"m"],[149,61,109,69],[149,62,109,70,"presence_ref"],[149,74,109,82],[149,75,109,83],[150,12,110,16],[150,16,110,22,"joinedPresences"],[150,31,110,37],[150,34,110,40,"newPresences"],[150,46,110,52],[150,47,110,53,"filter"],[150,53,110,59],[150,54,110,61,"m"],[150,55,110,62],[150,59,110,67,"curPresenceRefs"],[150,74,110,82],[150,75,110,83,"indexOf"],[150,82,110,90],[150,83,110,91,"m"],[150,84,110,92],[150,85,110,93,"presence_ref"],[150,97,110,105],[150,98,110,106],[150,101,110,109],[150,102,110,110],[150,103,110,111],[151,12,111,16],[151,16,111,22,"leftPresences"],[151,29,111,35],[151,32,111,38,"currentPresences"],[151,48,111,54],[151,49,111,55,"filter"],[151,55,111,61],[151,56,111,63,"m"],[151,57,111,64],[151,61,111,69,"newPresenceRefs"],[151,76,111,84],[151,77,111,85,"indexOf"],[151,84,111,92],[151,85,111,93,"m"],[151,86,111,94],[151,87,111,95,"presence_ref"],[151,99,111,107],[151,100,111,108],[151,103,111,111],[151,104,111,112],[151,105,111,113],[152,12,112,16],[152,16,112,20,"joinedPresences"],[152,31,112,35],[152,32,112,36,"length"],[152,38,112,42],[152,41,112,45],[152,42,112,46],[152,44,112,48],[153,14,113,20,"joins"],[153,19,113,25],[153,20,113,26,"key"],[153,23,113,29],[153,24,113,30],[153,27,113,33,"joinedPresences"],[153,42,113,48],[154,12,114,16],[155,12,115,16],[155,16,115,20,"leftPresences"],[155,29,115,33],[155,30,115,34,"length"],[155,36,115,40],[155,39,115,43],[155,40,115,44],[155,42,115,46],[156,14,116,20,"leaves"],[156,20,116,26],[156,21,116,27,"key"],[156,24,116,30],[156,25,116,31],[156,28,116,34,"leftPresences"],[156,41,116,47],[157,12,117,16],[158,10,118,12],[158,11,118,13],[158,17,119,17],[159,12,120,16,"joins"],[159,17,120,21],[159,18,120,22,"key"],[159,21,120,25],[159,22,120,26],[159,25,120,29,"newPresences"],[159,37,120,41],[160,10,121,12],[161,8,122,8],[161,9,122,9],[161,10,122,10],[162,8,123,8],[162,15,123,15],[162,19,123,19],[162,20,123,20,"syncDiff"],[162,28,123,28],[162,29,123,29,"state"],[162,34,123,34],[162,36,123,36],[163,10,123,38,"joins"],[163,15,123,43],[164,10,123,45,"leaves"],[165,8,123,52],[165,9,123,53],[165,11,123,55,"onJoin"],[165,17,123,61],[165,19,123,63,"onLeave"],[165,26,123,70],[165,27,123,71],[166,6,124,4],[167,6,125,4],[168,0,126,0],[169,0,127,0],[170,0,128,0],[171,0,129,0],[172,0,130,0],[173,0,131,0],[174,0,132,0],[175,0,133,0],[176,0,134,0],[177,4,125,4],[178,6,125,4,"key"],[178,9,125,4],[179,6,125,4,"value"],[179,11,125,4],[179,13,135,4],[179,22,135,11,"syncDiff"],[179,30,135,19,"syncDiff"],[179,31,135,20,"state"],[179,36,135,25],[179,38,135,27,"diff"],[179,42,135,31],[179,44,135,33,"onJoin"],[179,50,135,39],[179,52,135,41,"onLeave"],[179,59,135,48],[179,61,135,50],[180,8,136,8],[180,12,136,8,"_joins$leaves"],[180,25,136,8],[180,28,136,34],[181,12,137,12,"joins"],[181,17,137,17],[181,19,137,19],[181,23,137,23],[181,24,137,24,"transformState"],[181,38,137,38],[181,39,137,39,"diff"],[181,43,137,43],[181,44,137,44,"joins"],[181,49,137,49],[181,50,137,50],[182,12,138,12,"leaves"],[182,18,138,18],[182,20,138,20],[182,24,138,24],[182,25,138,25,"transformState"],[182,39,138,39],[182,40,138,40,"diff"],[182,44,138,44],[182,45,138,45,"leaves"],[182,51,138,51],[183,10,139,8],[183,11,139,9],[184,10,136,16,"joins"],[184,15,136,21],[184,18,136,21,"_joins$leaves"],[184,31,136,21],[184,32,136,16,"joins"],[184,37,136,21],[185,10,136,23,"leaves"],[185,16,136,29],[185,19,136,29,"_joins$leaves"],[185,32,136,29],[185,33,136,23,"leaves"],[185,39,136,29],[186,8,140,8],[186,12,140,12],[186,13,140,13,"onJoin"],[186,19,140,19],[186,21,140,21],[187,10,141,12,"onJoin"],[187,16,141,18],[187,19,141,21,"onJoin"],[187,20,141,21],[187,25,141,27],[187,26,141,29],[187,27,141,30],[188,8,142,8],[189,8,143,8],[189,12,143,12],[189,13,143,13,"onLeave"],[189,20,143,20],[189,22,143,22],[190,10,144,12,"onLeave"],[190,17,144,19],[190,20,144,22,"onLeave"],[190,21,144,22],[190,26,144,28],[190,27,144,30],[190,28,144,31],[191,8,145,8],[192,8,146,8],[192,12,146,12],[192,13,146,13,"map"],[192,16,146,16],[192,17,146,17,"joins"],[192,22,146,22],[192,24,146,24],[192,25,146,25,"key"],[192,28,146,28],[192,30,146,30,"newPresences"],[192,42,146,42],[192,47,146,47],[193,10,147,12],[193,14,147,16,"_a"],[193,16,147,18],[194,10,148,12],[194,14,148,18,"currentPresences"],[194,30,148,34],[194,33,148,37],[194,34,148,38,"_a"],[194,36,148,40],[194,39,148,43,"state"],[194,44,148,48],[194,45,148,49,"key"],[194,48,148,52],[194,49,148,53],[194,55,148,59],[194,59,148,63],[194,63,148,67,"_a"],[194,65,148,69],[194,70,148,69,"undefined"],[194,79,148,80],[194,82,148,83,"_a"],[194,84,148,85],[194,87,148,88],[194,89,148,90],[195,10,149,12,"state"],[195,15,149,17],[195,16,149,18,"key"],[195,19,149,21],[195,20,149,22],[195,23,149,25],[195,27,149,29],[195,28,149,30,"cloneDeep"],[195,37,149,39],[195,38,149,40,"newPresences"],[195,50,149,52],[195,51,149,53],[196,10,150,12],[196,14,150,16,"currentPresences"],[196,30,150,32],[196,31,150,33,"length"],[196,37,150,39],[196,40,150,42],[196,41,150,43],[196,43,150,45],[197,12,151,16],[197,16,151,22,"joinedPresenceRefs"],[197,34,151,40],[197,37,151,43,"state"],[197,42,151,48],[197,43,151,49,"key"],[197,46,151,52],[197,47,151,53],[197,48,151,54,"map"],[197,51,151,57],[197,52,151,59,"m"],[197,53,151,60],[197,57,151,65,"m"],[197,58,151,66],[197,59,151,67,"presence_ref"],[197,71,151,79],[197,72,151,80],[198,12,152,16],[198,16,152,22,"curPresences"],[198,28,152,34],[198,31,152,37,"currentPresences"],[198,47,152,53],[198,48,152,54,"filter"],[198,54,152,60],[198,55,152,62,"m"],[198,56,152,63],[198,60,152,68,"joinedPresenceRefs"],[198,78,152,86],[198,79,152,87,"indexOf"],[198,86,152,94],[198,87,152,95,"m"],[198,88,152,96],[198,89,152,97,"presence_ref"],[198,101,152,109],[198,102,152,110],[198,105,152,113],[198,106,152,114],[198,107,152,115],[199,12,153,16,"state"],[199,17,153,21],[199,18,153,22,"key"],[199,21,153,25],[199,22,153,26],[199,23,153,27,"unshift"],[199,30,153,34],[199,31,153,35],[199,34,153,38,"curPresences"],[199,46,153,50],[199,47,153,51],[200,10,154,12],[201,10,155,12,"onJoin"],[201,16,155,18],[201,17,155,19,"key"],[201,20,155,22],[201,22,155,24,"currentPresences"],[201,38,155,40],[201,40,155,42,"newPresences"],[201,52,155,54],[201,53,155,55],[202,8,156,8],[202,9,156,9],[202,10,156,10],[203,8,157,8],[203,12,157,12],[203,13,157,13,"map"],[203,16,157,16],[203,17,157,17,"leaves"],[203,23,157,23],[203,25,157,25],[203,26,157,26,"key"],[203,29,157,29],[203,31,157,31,"leftPresences"],[203,44,157,44],[203,49,157,49],[204,10,158,12],[204,14,158,16,"currentPresences"],[204,30,158,32],[204,33,158,35,"state"],[204,38,158,40],[204,39,158,41,"key"],[204,42,158,44],[204,43,158,45],[205,10,159,12],[205,14,159,16],[205,15,159,17,"currentPresences"],[205,31,159,33],[205,33,160,16],[206,10,161,12],[206,14,161,18,"presenceRefsToRemove"],[206,34,161,38],[206,37,161,41,"leftPresences"],[206,50,161,54],[206,51,161,55,"map"],[206,54,161,58],[206,55,161,60,"m"],[206,56,161,61],[206,60,161,66,"m"],[206,61,161,67],[206,62,161,68,"presence_ref"],[206,74,161,80],[206,75,161,81],[207,10,162,12,"currentPresences"],[207,26,162,28],[207,29,162,31,"currentPresences"],[207,45,162,47],[207,46,162,48,"filter"],[207,52,162,54],[207,53,162,56,"m"],[207,54,162,57],[207,58,162,62,"presenceRefsToRemove"],[207,78,162,82],[207,79,162,83,"indexOf"],[207,86,162,90],[207,87,162,91,"m"],[207,88,162,92],[207,89,162,93,"presence_ref"],[207,101,162,105],[207,102,162,106],[207,105,162,109],[207,106,162,110],[207,107,162,111],[208,10,163,12,"state"],[208,15,163,17],[208,16,163,18,"key"],[208,19,163,21],[208,20,163,22],[208,23,163,25,"currentPresences"],[208,39,163,41],[209,10,164,12,"onLeave"],[209,17,164,19],[209,18,164,20,"key"],[209,21,164,23],[209,23,164,25,"currentPresences"],[209,39,164,41],[209,41,164,43,"leftPresences"],[209,54,164,56],[209,55,164,57],[210,10,165,12],[210,14,165,16,"currentPresences"],[210,30,165,32],[210,31,165,33,"length"],[210,37,165,39],[210,42,165,44],[210,43,165,45],[210,45,166,16],[210,52,166,23,"state"],[210,57,166,28],[210,58,166,29,"key"],[210,61,166,32],[210,62,166,33],[211,8,167,8],[211,9,167,9],[211,10,167,10],[212,8,168,8],[212,15,168,15,"state"],[212,20,168,20],[213,6,169,4],[214,6,170,4],[215,4,170,4],[216,6,170,4,"key"],[216,9,170,4],[217,6,170,4,"value"],[217,11,170,4],[217,13,171,4],[217,22,171,11,"map"],[217,25,171,14,"map"],[217,26,171,15,"obj"],[217,29,171,18],[217,31,171,20,"func"],[217,35,171,24],[217,37,171,26],[218,8,172,8],[218,15,172,15,"Object"],[218,21,172,21],[218,22,172,22,"getOwnPropertyNames"],[218,41,172,41],[218,42,172,42,"obj"],[218,45,172,45],[218,46,172,46],[218,47,172,47,"map"],[218,50,172,50],[218,51,172,52,"key"],[218,54,172,55],[218,58,172,60,"func"],[218,62,172,64],[218,63,172,65,"key"],[218,66,172,68],[218,68,172,70,"obj"],[218,71,172,73],[218,72,172,74,"key"],[218,75,172,77],[218,76,172,78],[218,77,172,79],[218,78,172,80],[219,6,173,4],[220,6,174,4],[221,0,175,0],[222,0,176,0],[223,0,177,0],[224,0,178,0],[225,0,179,0],[226,0,180,0],[227,0,181,0],[228,0,182,0],[229,0,183,0],[230,0,184,0],[231,0,185,0],[232,0,186,0],[233,0,187,0],[234,0,188,0],[235,0,189,0],[236,0,190,0],[237,0,191,0],[238,0,192,0],[239,0,193,0],[240,0,194,0],[241,0,195,0],[242,0,196,0],[243,4,174,4],[244,6,174,4,"key"],[244,9,174,4],[245,6,174,4,"value"],[245,11,174,4],[245,13,197,4],[245,22,197,11,"transformState"],[245,36,197,25,"transformState"],[245,37,197,26,"state"],[245,42,197,31],[245,44,197,33],[246,8,198,8,"state"],[246,13,198,13],[246,16,198,16],[246,20,198,20],[246,21,198,21,"cloneDeep"],[246,30,198,30],[246,31,198,31,"state"],[246,36,198,36],[246,37,198,37],[247,8,199,8],[247,15,199,15,"Object"],[247,21,199,21],[247,22,199,22,"getOwnPropertyNames"],[247,41,199,41],[247,42,199,42,"state"],[247,47,199,47],[247,48,199,48],[247,49,199,49,"reduce"],[247,55,199,55],[247,56,199,56],[247,57,199,57,"newState"],[247,65,199,65],[247,67,199,67,"key"],[247,70,199,70],[247,75,199,75],[248,10,200,12],[248,14,200,18,"presences"],[248,23,200,27],[248,26,200,30,"state"],[248,31,200,35],[248,32,200,36,"key"],[248,35,200,39],[248,36,200,40],[249,10,201,12],[249,14,201,16],[249,21,201,23],[249,25,201,27,"presences"],[249,34,201,36],[249,36,201,38],[250,12,202,16,"newState"],[250,20,202,24],[250,21,202,25,"key"],[250,24,202,28],[250,25,202,29],[250,28,202,32,"presences"],[250,37,202,41],[250,38,202,42,"metas"],[250,43,202,47],[250,44,202,48,"map"],[250,47,202,51],[250,48,202,53,"presence"],[250,56,202,61],[250,60,202,66],[251,14,203,20,"presence"],[251,22,203,28],[251,23,203,29],[251,37,203,43],[251,38,203,44],[251,41,203,47,"presence"],[251,49,203,55],[251,50,203,56],[251,59,203,65],[251,60,203,66],[252,14,204,20],[252,21,204,27,"presence"],[252,29,204,35],[252,30,204,36],[252,39,204,45],[252,40,204,46],[253,14,205,20],[253,21,205,27,"presence"],[253,29,205,35],[253,30,205,36],[253,44,205,50],[253,45,205,51],[254,14,206,20],[254,21,206,27,"presence"],[254,29,206,35],[255,12,207,16],[255,13,207,17],[255,14,207,18],[256,10,208,12],[256,11,208,13],[256,17,209,17],[257,12,210,16,"newState"],[257,20,210,24],[257,21,210,25,"key"],[257,24,210,28],[257,25,210,29],[257,28,210,32,"presences"],[257,37,210,41],[258,10,211,12],[259,10,212,12],[259,17,212,19,"newState"],[259,25,212,27],[260,8,213,8],[260,9,213,9],[260,11,213,11],[260,12,213,12],[260,13,213,13],[260,14,213,14],[261,6,214,4],[262,6,215,4],[263,4,215,4],[264,6,215,4,"key"],[264,9,215,4],[265,6,215,4,"value"],[265,11,215,4],[265,13,216,4],[265,22,216,11,"cloneDeep"],[265,31,216,20,"cloneDeep"],[265,32,216,21,"obj"],[265,35,216,24],[265,37,216,26],[266,8,217,8],[266,15,217,15,"JSON"],[266,19,217,19],[266,20,217,20,"parse"],[266,25,217,25],[266,26,217,26,"JSON"],[266,30,217,30],[266,31,217,31,"stringify"],[266,40,217,40],[266,41,217,41,"obj"],[266,44,217,44],[266,45,217,45],[266,46,217,46],[267,6,218,4],[268,4,218,5],[269,2,218,5],[270,2,236,0,"exports"],[270,9,236,7],[270,10,236,8,"default"],[270,17,236,15],[270,20,236,18,"RealtimePresence"],[270,36,236,34],[271,0,236,35],[271,3]],"functionMap":{"names":["<global>","<anonymous>","RealtimePresence","constructor","caller.onJoin","caller.onLeave","caller.onSync","channel._on$argument_2","pendingDiffs.forEach$argument_0","onJoin$argument_0","onLeave$argument_0","onSync$argument_0","syncState","map$argument_1","newPresences.map$argument_0","currentPresences.map$argument_0","newPresences.filter$argument_0","currentPresences.filter$argument_0","syncDiff","onJoin","onLeave","state.key.map$argument_0","leftPresences.map$argument_0","map","Object.getOwnPropertyNames.map$argument_0","transformState","Object.getOwnPropertyNames.reduce$argument_0","presences.metas.map$argument_0","cloneDeep","onSync","inPendingSyncState"],"mappings":"AAA;CCQ;CDI;AEC;ICgB;oBCO,SD;qBEC,SF;oBGC,SH;2CIM;sCCI;aDE;SJG;0CIC;SJS;oBMC;SNO;qBOC;SPO;oBQC;SRE;KDC;IUW;wBCK;SDI;mCCC;yDCG,qBD;6DEC,qBF;4DGC,kDH;8DIC,kDJ;SDW;KVE;IgBW;qBCM,SD;sBEG,SF;wBLE;0DQK,qBR;6DIC,qDJ;SKI;yBLC;2DSI,qBT;uDIC,uDJ;SKK;KhBE;IqBE;mDCC,4BD;KrBC;IuBwB;wDCE;oDCG;iBDK;SDM;KvBC;I0BE;K1BE;IiBE;KjBE;IkBE;KlBE;I2BE;K3BE;I4BE;K5BE;CFC"},"hasCjsExports":true},"type":"js/module"}]}
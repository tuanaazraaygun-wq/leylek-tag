{"dependencies":[{"name":"./encodePacket.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":71,"index":71}}],"key":"l0XJith170aiQBKbDxvaf5HJzjc=","exportNames":["*"],"imports":1}},{"name":"./decodePacket.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":72},"end":{"line":2,"column":49,"index":121}}],"key":"k2ePvc7PPyN9sm4h8mrZRv0s/Hg=","exportNames":["*"],"imports":1}},{"name":"./commons.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":122},"end":{"line":3,"column":45,"index":167}}],"key":"glGFVKq6JnHqcEVNii1WndfU66Y=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function(g,r,_i,a,m,e,d){\"use strict\";Object.defineProperty(e,'__esModule',{value:!0}),e.createPacketEncoderStream=function(){return new TransformStream({transform(n,o){(0,t.encodePacketToBinary)(n,t=>{const c=t.length;let i;if(c<126)i=new Uint8Array(1),new DataView(i.buffer).setUint8(0,c);else if(c<65536){i=new Uint8Array(3);const t=new DataView(i.buffer);t.setUint8(0,126),t.setUint16(1,c)}else{i=new Uint8Array(9);const t=new DataView(i.buffer);t.setUint8(0,127),t.setBigUint64(1,BigInt(c))}n.data&&\"string\"!=typeof n.data&&(i[0]|=128),o.enqueue(i),o.enqueue(t)})}})},e.createPacketDecoderStream=function(t,c){u||(u=new TextDecoder);const i=[];let f=0,b=-1,w=!1;return new TransformStream({transform(P,h){for(i.push(P);;){if(0===f){if(s(i)<1)break;const t=l(i,1);w=!(128&~t[0]),b=127&t[0],f=b<126?3:126===b?1:2}else if(1===f){if(s(i)<2)break;const t=l(i,2);b=new DataView(t.buffer,t.byteOffset,t.length).getUint16(0),f=3}else if(2===f){if(s(i)<8)break;const t=l(i,8),n=new DataView(t.buffer,t.byteOffset,t.length),c=n.getUint32(0);if(c>Math.pow(2,21)-1){h.enqueue(o.ERROR_PACKET);break}b=c*Math.pow(2,32)+n.getUint32(4),f=3}else{if(s(i)<b)break;const t=l(i,b);h.enqueue((0,n.decodePacket)(w?t:u.decode(t),c)),f=0}if(0===b||b>t){h.enqueue(o.ERROR_PACKET);break}}}})},Object.defineProperty(e,\"protocol\",{enumerable:!0,get:function(){return b}}),Object.defineProperty(e,\"encodePacket\",{enumerable:!0,get:function(){return t.encodePacket}}),Object.defineProperty(e,\"encodePayload\",{enumerable:!0,get:function(){return i}}),Object.defineProperty(e,\"decodePacket\",{enumerable:!0,get:function(){return n.decodePacket}}),Object.defineProperty(e,\"decodePayload\",{enumerable:!0,get:function(){return f}});var t=r(d[0]),n=r(d[1]),o=r(d[2]);const c=String.fromCharCode(30),i=(n,o)=>{const i=n.length,f=new Array(i);let u=0;n.forEach((n,s)=>{(0,t.encodePacket)(n,!1,t=>{f[s]=t,++u===i&&o(f.join(c))})})},f=(t,o)=>{const i=t.split(c),f=[];for(let t=0;t<i.length;t++){const c=(0,n.decodePacket)(i[t],o);if(f.push(c),\"error\"===c.type)break}return f};let u;function s(t){return t.reduce((t,n)=>t+n.length,0)}function l(t,n){if(t[0].length===n)return t.shift();const o=new Uint8Array(n);let c=0;for(let i=0;i<n;i++)o[i]=t[0][c++],c===t[0].length&&(t.shift(),c=0);return t.length&&c<t[0].length&&(t[0]=t[0].slice(c)),o}const b=4});","lineCount":1,"map":[[1,91,32,0,"e"],[1,93,32,0,"createPacketEncoderStream"],[1,119,32,7],[1,130,33,4],[1,137,33,11],[1,141,33,15,"TransformStream"],[1,157,33,31],[1,158,34,8,"transform"],[1,168,34,18,"packet"],[1,170,34,26,"controller"],[1,174,35,12],[1,176,35,12,"encodePacketToBinary"],[1,178,35,32,"encodePacketToBinary"],[1,200,35,33,"packet"],[1,202,35,42,"encodedPacket"],[1,206,36,16],[1,212,36,22,"payloadLength"],[1,214,36,38,"encodedPacket"],[1,216,36,52,"length"],[1,223,37,16],[1,227,37,20,"header"],[1,229,39,16],[1,232,39,20,"payloadLength"],[1,234,39,36],[1,238,40,20,"header"],[1,240,40,29],[1,244,40,33,"Uint8Array"],[1,255,40,44],[1,258,41,20],[1,262,41,24,"DataView"],[1,271,41,33,"header"],[1,273,41,40,"buffer"],[1,281,41,48,"setUint8"],[1,290,41,57],[1,292,41,60,"payloadLength"],[1,300,43,21],[1,303,43,25,"payloadLength"],[1,305,43,41],[1,311,43,48],[1,312,44,20,"header"],[1,314,44,29],[1,318,44,33,"Uint8Array"],[1,329,44,44],[1,332,45,20],[1,338,45,26,"view"],[1,340,45,33],[1,344,45,37,"DataView"],[1,353,45,46,"header"],[1,355,45,53,"buffer"],[1,363,46,20,"view"],[1,365,46,25,"setUint8"],[1,374,46,34],[1,376,46,37],[1,381,47,20,"view"],[1,383,47,25,"setUint16"],[1,393,47,35],[1,395,47,38,"payloadLength"],[1,397,48,16],[1,402,49,21],[1,403,50,20,"header"],[1,405,50,29],[1,409,50,33,"Uint8Array"],[1,420,50,44],[1,423,51,20],[1,429,51,26,"view"],[1,431,51,33],[1,435,51,37,"DataView"],[1,444,51,46,"header"],[1,446,51,53,"buffer"],[1,454,52,20,"view"],[1,456,52,25,"setUint8"],[1,465,52,34],[1,467,52,37],[1,472,53,20,"view"],[1,474,53,25,"setBigUint64"],[1,487,53,38],[1,489,53,41,"BigInt"],[1,496,53,48,"payloadLength"],[1,499,54,16],[1,500,56,20,"packet"],[1,502,56,27,"data"],[1,508,56,58],[1,525,56,42,"packet"],[1,527,56,49,"data"],[1,534,57,20,"header"],[1,536,57,27],[1,540,57,33],[1,545,59,16,"controller"],[1,547,59,27,"enqueue"],[1,555,59,35,"header"],[1,558,60,16,"controller"],[1,560,60,27,"enqueue"],[1,568,60,35,"encodedPacket"],[1,572,62,8],[1,575,64,0],[1,577,87,0,"e"],[1,579,87,0,"createPacketDecoderStream"],[1,605,87,7],[1,614,87,42,"maxPayload"],[1,616,87,54,"binaryType"],[1,619,88,9,"TEXT_DECODER"],[1,623,89,8,"TEXT_DECODER"],[1,625,89,23],[1,629,89,27,"TextDecoder"],[1,642,91,4],[1,648,91,10,"chunks"],[1,650,91,19],[1,653,92,4],[1,657,92,8,"state"],[1,659,92,16],[1,661,93,8,"expectedLength"],[1,664,93,22],[1,666,94,8,"isBinary"],[1,669,94,19],[1,671,95,4],[1,678,95,11],[1,682,95,15,"TransformStream"],[1,698,95,31],[1,699,96,8,"transform"],[1,709,96,18,"chunk"],[1,711,96,25,"controller"],[1,714,98,12],[1,718,97,12,"chunks"],[1,720,97,19,"push"],[1,725,97,24,"chunk"],[1,730,98,25],[1,731,99,16],[1,734,99,30],[1,738,99,20,"state"],[1,740,99,57],[1,741,100,20],[1,744,100,24,"totalLength"],[1,746,100,36,"chunks"],[1,749,100,46],[1,751,101,24],[1,757,103,20],[1,763,103,26,"header"],[1,765,103,35,"concatChunks"],[1,767,103,48,"chunks"],[1,769,103,56],[1,772,104,20,"isBinary"],[1,776,104,54],[1,781,104,32,"header"],[1,783,104,39],[1,787,105,20,"expectedLength"],[1,789,105,49],[1,793,105,37,"header"],[1,795,105,44],[1,798,107,24,"state"],[1,800,106,24,"expectedLength"],[1,802,106,41],[1,806,107,32],[1,808,109,48],[1,814,109,29,"expectedLength"],[1,816,110,32],[1,818,113,32],[1,819,115,16],[1,825,116,21],[1,828,116,35],[1,832,116,25,"state"],[1,834,116,74],[1,835,117,20],[1,838,117,24,"totalLength"],[1,840,117,36,"chunks"],[1,843,117,46],[1,845,118,24],[1,851,120,20],[1,857,120,26,"headerArray"],[1,859,120,40,"concatChunks"],[1,861,120,53,"chunks"],[1,863,120,61],[1,866,121,20,"expectedLength"],[1,868,121,37],[1,872,121,41,"DataView"],[1,881,121,50,"headerArray"],[1,883,121,62,"buffer"],[1,890,121,70,"headerArray"],[1,892,121,82,"byteOffset"],[1,903,121,94,"headerArray"],[1,905,121,106,"length"],[1,913,121,114,"getUint16"],[1,923,121,124],[1,926,122,20,"state"],[1,928,122,28],[1,929,123,16],[1,935,124,21],[1,938,124,35],[1,942,124,25,"state"],[1,944,124,74],[1,945,125,20],[1,948,125,24,"totalLength"],[1,950,125,36,"chunks"],[1,953,125,46],[1,955,126,24],[1,961,128,20],[1,967,128,26,"headerArray"],[1,969,128,40,"concatChunks"],[1,971,128,53,"chunks"],[1,973,128,61],[1,976,129,26,"view"],[1,978,129,33],[1,982,129,37,"DataView"],[1,991,129,46,"headerArray"],[1,993,129,58,"buffer"],[1,1000,129,66,"headerArray"],[1,1002,129,78,"byteOffset"],[1,1013,129,90,"headerArray"],[1,1015,129,102,"length"],[1,1023,130,26,"n"],[1,1025,130,30,"view"],[1,1027,130,35,"getUint32"],[1,1037,130,45],[1,1040,131,20],[1,1043,131,24,"n"],[1,1045,131,28,"Math"],[1,1050,131,33,"pow"],[1,1054,131,37],[1,1056,131,38],[1,1060,131,51],[1,1062,131,54],[1,1063,133,24,"controller"],[1,1065,133,35,"enqueue"],[1,1073,133,43,"ERROR_PACKET"],[1,1075,133,55,"ERROR_PACKET"],[1,1089,134,24],[1,1094,135,20],[1,1095,136,20,"expectedLength"],[1,1097,136,37,"n"],[1,1099,136,41,"Math"],[1,1104,136,46,"pow"],[1,1108,136,50],[1,1110,136,53],[1,1114,136,59,"view"],[1,1116,136,64,"getUint32"],[1,1126,136,74],[1,1129,137,20,"state"],[1,1131,137,28],[1,1132,138,16],[1,1137,139,21],[1,1138,140,20],[1,1141,140,24,"totalLength"],[1,1143,140,36,"chunks"],[1,1146,140,46,"expectedLength"],[1,1148,141,24],[1,1154,143,20],[1,1160,143,26,"data"],[1,1162,143,33,"concatChunks"],[1,1164,143,46,"chunks"],[1,1166,143,54,"expectedLength"],[1,1169,144,20,"controller"],[1,1171,144,31,"enqueue"],[1,1180,144,39],[1,1182,144,39,"decodePacket"],[1,1184,144,51,"decodePacket"],[1,1198,144,52,"isBinary"],[1,1200,144,63,"data"],[1,1202,144,70,"TEXT_DECODER"],[1,1204,144,83,"decode"],[1,1211,144,90,"data"],[1,1214,144,97,"binaryType"],[1,1218,145,20,"state"],[1,1220,145,28],[1,1221,146,16],[1,1222,147,16],[1,1225,147,39],[1,1229,147,20,"expectedLength"],[1,1232,147,44,"expectedLength"],[1,1234,147,61,"maxPayload"],[1,1236,147,73],[1,1237,148,20,"controller"],[1,1239,148,31,"enqueue"],[1,1247,148,39,"ERROR_PACKET"],[1,1249,148,51,"ERROR_PACKET"],[1,1263,149,20],[1,1268,150,16],[1,1269,151,12],[1,1270,152,8],[1,1273,154,0],[1,1275,155,0,"Object"],[1,1282,155,0,"defineProperty"],[1,1297,155,0,"e"],[1,1299,155,0],[1,1311,155,0,"enumerable"],[1,1323,155,0],[1,1325,155,0,"get"],[1,1329,155,0],[1,1347,155,0,"protocol"],[1,1348,155,0],[1,1352,156,0,"Object"],[1,1359,156,0,"defineProperty"],[1,1374,156,0,"e"],[1,1376,156,0],[1,1392,156,0,"enumerable"],[1,1404,156,0],[1,1406,156,0,"get"],[1,1410,156,0],[1,1428,156,9,"encodePacket"],[1,1430,156,21,"encodePacket"],[1,1442,156,21],[1,1446,156,0,"Object"],[1,1453,156,0,"defineProperty"],[1,1468,156,0,"e"],[1,1470,156,0],[1,1487,156,0,"enumerable"],[1,1499,156,0],[1,1501,156,0,"get"],[1,1505,156,0],[1,1523,156,23,"encodePayload"],[1,1524,156,36],[1,1528,156,0,"Object"],[1,1535,156,0,"defineProperty"],[1,1550,156,0,"e"],[1,1552,156,0],[1,1568,156,0,"enumerable"],[1,1580,156,0],[1,1582,156,0,"get"],[1,1586,156,0],[1,1604,156,38,"decodePacket"],[1,1606,156,50,"decodePacket"],[1,1618,156,50],[1,1622,156,0,"Object"],[1,1629,156,0,"defineProperty"],[1,1644,156,0,"e"],[1,1646,156,0],[1,1663,156,0,"enumerable"],[1,1675,156,0],[1,1677,156,0,"get"],[1,1681,156,0],[1,1699,156,52,"decodePayload"],[1,1700,156,65],[1,1704,1,0],[1,1708,1,0,"_encodePacketJs"],[1,1710,1,0,"r"],[1,1712,1,0,"d"],[1,1714,1,0],[1,1718,2,0,"_decodePacketJs"],[1,1720,2,0,"r"],[1,1722,2,0,"d"],[1,1724,2,0],[1,1728,3,0,"_commonsJs"],[1,1730,3,0,"r"],[1,1732,3,0,"d"],[1,1734,3,0],[1,1738,4,0],[1,1744,4,6,"SEPARATOR"],[1,1746,4,18,"String"],[1,1753,4,25,"fromCharCode"],[1,1766,4,38],[1,1770,5,6,"encodePayload"],[1,1772,5,22,"encodePayload"],[1,1773,5,23,"packets"],[1,1775,5,32,"callback"],[1,1780,7,4],[1,1786,7,10,"length"],[1,1788,7,19,"packets"],[1,1790,7,27,"length"],[1,1797,8,10,"encodedPackets"],[1,1799,8,27],[1,1803,8,31,"Array"],[1,1809,8,37,"length"],[1,1812,9,4],[1,1816,9,8,"count"],[1,1818,9,16],[1,1820,10,4,"packets"],[1,1822,10,12,"forEach"],[1,1830,10,20],[1,1831,10,21,"packet"],[1,1833,10,29,"i"],[1,1839,12,8],[1,1841,12,8,"encodePacket"],[1,1843,12,20,"encodePacket"],[1,1857,12,21,"packet"],[1,1860,12,29],[1,1862,12,37,"encodedPacket"],[1,1866,13,12,"encodedPackets"],[1,1868,13,27,"i"],[1,1871,13,32,"encodedPacket"],[1,1875,14,18,"count"],[1,1879,14,28,"length"],[1,1882,15,16,"callback"],[1,1884,15,25,"encodedPackets"],[1,1886,15,40,"join"],[1,1891,15,45,"SEPARATOR"],[1,1900,20,6,"decodePayload"],[1,1902,20,22,"decodePayload"],[1,1903,20,23,"encodedPayload"],[1,1905,20,39,"binaryType"],[1,1910,21,4],[1,1916,21,10,"encodedPackets"],[1,1918,21,27,"encodedPayload"],[1,1920,21,42,"split"],[1,1926,21,48,"SEPARATOR"],[1,1929,22,10,"packets"],[1,1931,22,20],[1,1934,23,4],[1,1938,23,9],[1,1942,23,13,"i"],[1,1944,23,17],[1,1946,23,20,"i"],[1,1948,23,24,"encodedPackets"],[1,1950,23,39,"length"],[1,1957,23,47,"i"],[1,1961,23,52],[1,1962,24,8],[1,1968,24,14,"decodedPacket"],[1,1971,24,30],[1,1973,24,30,"decodePacket"],[1,1975,24,42,"decodePacket"],[1,1989,24,43,"encodedPackets"],[1,1991,24,58,"i"],[1,1994,24,62,"binaryType"],[1,1997,26,8],[1,2000,25,8,"packets"],[1,2002,25,16,"push"],[1,2007,25,21,"decodedPacket"],[1,2010,26,35],[1,2020,26,12,"decodedPacket"],[1,2022,26,26,"type"],[1,2027,27,12],[1,2032,29,4],[1,2033,30,4],[1,2040,30,11,"packets"],[1,2043,65,0],[1,2047,65,4,"TEXT_DECODER"],[1,2049,66,0],[1,2058,66,9,"totalLength"],[1,2060,66,21,"chunks"],[1,2063,67,4],[1,2070,67,11,"chunks"],[1,2072,67,18,"reduce"],[1,2079,67,25],[1,2080,67,26,"acc"],[1,2082,67,31,"chunk"],[1,2086,67,41,"acc"],[1,2088,67,47,"chunk"],[1,2090,67,53,"length"],[1,2097,67,61],[1,2099,68,0],[1,2100,69,0],[1,2109,69,9,"concatChunks"],[1,2111,69,22,"chunks"],[1,2113,69,30,"size"],[1,2116,70,4],[1,2119,70,8,"chunks"],[1,2121,70,15],[1,2124,70,18,"length"],[1,2133,70,29,"size"],[1,2135,71,8],[1,2142,71,15,"chunks"],[1,2144,71,22,"shift"],[1,2152,73,4],[1,2158,73,10,"buffer"],[1,2160,73,19],[1,2164,73,23,"Uint8Array"],[1,2175,73,34,"size"],[1,2178,74,4],[1,2182,74,8,"j"],[1,2184,74,12],[1,2186,75,4],[1,2190,75,9],[1,2194,75,13,"i"],[1,2196,75,17],[1,2198,75,20,"i"],[1,2200,75,24,"size"],[1,2202,75,30,"i"],[1,2206,76,8,"buffer"],[1,2208,76,15,"i"],[1,2211,76,20,"chunks"],[1,2213,76,27],[1,2216,76,30,"j"],[1,2221,77,12,"j"],[1,2225,77,18,"chunks"],[1,2227,77,25],[1,2230,77,28,"length"],[1,2239,78,12,"chunks"],[1,2241,78,19,"shift"],[1,2249,79,12,"j"],[1,2251,79,16],[1,2254,85,4],[1,2261,82,8,"chunks"],[1,2263,82,15,"length"],[1,2271,82,25,"j"],[1,2273,82,29,"chunks"],[1,2275,82,36],[1,2278,82,39,"length"],[1,2287,83,8,"chunks"],[1,2289,83,15],[1,2292,83,20,"chunks"],[1,2294,83,27],[1,2297,83,30,"slice"],[1,2303,83,36,"j"],[1,2307,85,11,"buffer"],[1,2308,86,0],[1,2309,155,7],[1,2315,155,13,"protocol"],[1,2317,155,24],[1,2318,155,26],[1,2321]],"functionMap":{"names":["<global>","encodePayload","packets.forEach$argument_0","encodePacket$argument_2","decodePayload","createPacketEncoderStream","TransformStream$argument_0.transform","encodePacketToBinary$argument_1","totalLength","chunks.reduce$argument_0","concatChunks","createPacketDecoderStream"],"mappings":"AAA;sBCI;oBCK;oCCE;SDK;KDC;CDC;sBIC;CJW;OKC;QCE;yCCC;aD0B;SDC;CLE;AQE;yBCC,kCD;CRC;AUC;CViB;OWC;QLS;SKwD;CXE"},"hasCjsExports":false},"type":"js/module"}]}